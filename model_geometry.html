<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>TiRiFiC - Model Geometry</title>
<!-- define european ISO charset -->
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<!-- favicon -->
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<!-- include style -->
<link rel="stylesheet" type="text/css" href="layout.css">
<!--[if IE]>
<link rel="stylesheet" type="text/css" href="layout_ie.css">
<![endif]-->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script
src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
</head>
  <body>
<!-- ************************* -->
<!-- ************************* -->
<!-- ********  HEADER  ******* -->
<!-- ************************* -->
<!-- ************************* -->
<div id="hdr">
<div class="t">
<div class="b">
<div class="l">
<div class="r">
<div class="bl">
<div class="br">
<div class="tl">
<div class="tr">
<div id="lh-col-white">
<!-- <h1 class="hdrle"> -->
<img class="tir" src="tirlogo.gif" alt="TiRiFiC logo"/> 
<!-- </h1> -->
</div>
<div id="rh-col-white">
<h1 class="hdr"> Model Geometry </h1>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ************************* -->
<!-- ************************* -->
<!-- ********  LINKS   ******* -->
<!-- ************************* -->
<!-- ************************* -->
<div id="lh-col">
<div class="tli">
<div class="b">
<div class="l">
<div class="r">
<div class="bl">
<div class="br">
<div class="tl">
<div class="trli">
<a class="button" href="index.html">HOME</a>
<a class="button" href="input_and_syntax.html">Input and Syntax</a>
<a class="button" href="modelling_strategy.html">Modelling Strategy</a>
<a class="button" href="model_geometry.html">Model Geometry</a>
<!-- <a class="button" href="model_parameters.html">Model Parameters</a> -->
<a class="button" href="model_fitting.html">Model Fitting</a>
<!-- <a class="button" href="fitting_parameters.html">Fitting Parameters</a> -->
<a class="button" href="output.html">Output</a>
<!-- <a class="button" href="output_parameters.html">Output Parameters</a> -->
<a class="button" href="parameter_index.html">Parameter Index</a>
<a class="button" href="examples.html">Examples</a>
<a class="button" href="gui.html">GUI</a>
<a class="button" href="bugs_and_development.html">Bugs and Development</a>
<a class="button" href="download_and_installation.html">Download and Installation</a>
<a class="button" href="contact_and_feedback.html">Contact and Feedback</a>
<a class="button" href="credits.html">Credits</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ************************* -->
<!-- ************************* -->
<!-- ********   BODY   ******* -->
<!-- ************************* -->
<!-- ************************* -->
<div id="rh-col">
<div class="tbody">
<div class="b">
<div class="l">
<div class="r">
<div class="bl">
<div class="br">
<div class="tl">
<div class="trbo">
<p class="paremph">
  This chapter describes how TiRiFiC creates a model data cube from
  the model parameters entered. The output of such a model data cube
  is achieved using the parameter <a
  href="output.html#OUTSET">OUTSET</a> explained in the chapter <a
  href="output.html">Output</a>. After a short introduction to the intrinsic <a href="#Coordinate system">Coordinate system</a>, a <a href="#Model generation: quick description">short description</a> of the TiRiFiC geometrical model is given, listing all model parameters, to then provide a <a href="#Model generation: detailed description">detailed mathematical description of the model</a>. We end this page with a short <a href="Summary of parameters described here">list of all geometric parameters</a> discussed on this page.
</p>



<p>
  <table align="right" width="350" border="0" cellpadding="0">
    <tr>
      <td>&nbsp;&nbsp;</td>
      <td width="30" align="right"><img src="singlering1.th.gif" width="350"></td>
    </tr>
    <tr>
      <td>&nbsp;</td>  
      <td width="350" height="10" align="right"><i>Fig. 1: the Tirific
      coordinate system is a right-handed Cartesian coordinate system
      with the first axis pointing to the North, second axis pointing
      to the East, and the third axis pointing toward the observer. A
      (sub-) ring of rotating material appears as an ellipse on the
      sky, determined by position angle (angle between North, origin,
      and receding half major axis of the projected ellipse) and
      inclination.</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
      <td width="30" align="right"><img src="singlering2.th.gif" width="350"></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td width="350" height="10" align="right"><i>Fig. 2: a TiRiFiC
      model is the result of multiple coordinate transformations of a
      cloud of point sources originally distributed along a face-on
      circle with a counterclockwise sense of rotation. The initial
      coordinates of the point source are determined by the azimuthal
      angle, or azimuth (<i>az/i> <i>&#966;</i>), the (projected) radius
      <i>R</i> (in arcsec), and the height above the plane <i>Z</i>
      (positive in the direction of the observer, measured in the
      observed reference system, in arcsec). Among other operations,
      the position of each point source is changed via a rotation
      about the North-axis (first axis) with the inclination and a
      subsequent rotation about the LOS axis by an angle of
      180&#176;+position angle (this rather strange transformation is
      chosen to conform with the <a
      href="http://www.astro.rug.nl/~gipsy/">GIPSY</a> definition of
      the position angle).</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>




<p>
  <center>
    <TABLE style="align:center" BORDER="1" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <TR>
        <TD ALIGN="left">
          Contents:
        </TD>
        <TD>
        </TD>
        <TR>
        <TD ALIGN="left">
          <ul class="par" style="list-style-type:none;padding-left:0em;margin-top:0px;margin-bottom:0px;">
            <li><a href="#Coordinate system">Coordinate system</a></li>
          </ul>
          <br>
          <ul class="par" style="list-style-type:none;padding-left:0em;margin-top:0px;margin-bottom:0px;">
            <li><a href="#Model generation: quick description">Model generation: quick description</a></li>
            <ul class="par" style="list-style-type:none;padding-left:2em;margin-top:0px;margin-bottom:0px;">
              <li><a href="#Radial nodes and parameter discretisationq">Radial nodes and parameter discretisation</a></li>
              <li><a href="#Quasi-random numbersq">Quasi-random numbers</a></li>
              <li><a href="#Multiple disksq">Multiple disks</a></li>
              <li><a href="#Face-on surface brightnessq">Face-on surface brightness</a></li>
              <li><a href="#Vertical density distributionq">Vertical density distribution</a></li>
              <li><a href="#Velocity structure Iq">Velocity structure I</a></li>
              <li><a href="#Vertical harmonic distortionsq">Vertical harmonic distortions</a></li>
              <li><a href="#Tilting to inclinationq">Tilting to inclination</a></li>
              <li><a href="#Shifts along principal axesq">Shifts along principal axes</a></li>
              <li><a href="#Velocity structure II (post-rotation)q">Velocity structure II (post-rotation)</a></li>
              <li><a href="#Rotating to position angleq">Rotating to position angle</a></li>
              <li><a href="#Velocity dispersionq">Velocity dispersion</a></li>
              <li><a href="#World coordinatesq">World coordinates</a></li>
              <li><a href="#Projectionq">Projection</a></li>
              <li><a href="#Griddingq">Gridding</a></li>
              <li><a href="#Instrumental functionq">Instrumental function</a></li>
            </ul>
          </ul>
        </td>
        <TD ALIGN="left">
          <ul class="par" style="list-style-type:none;padding-left:0em;margin-top:0px;margin-bottom:0px;">
            <li><a href="#Model generation: detailed description">Model generation: detailed description</a></li>
            <ul class="par" style="list-style-type:none;padding-left:2em;margin-top:0px;margin-bottom:0px;">
              <li><a href="#Radial nodes and parameter discretisation">Radial nodes and parameter discretisation</a></li>
              <li><a href="#Quasi-random numbers">Quasi-random numbers</a></li>
              <li><a href="#Multiple disks">Multiple disks</a></li>
              <li><a href="#Face-on surface brightness">Face-on surface brightness</a></li>
              <li><a href="#Vertical density distribution">Vertical density distribution</a></li>
              <li><a href="#Velocity structure I">Velocity structure I</a></li>
              <li><a href="#Vertical harmonic distortions">Vertical harmonic distortions</a></li>
              <li><a href="#Tilting to inclination">Tilting to inclination</a></li>
              <li><a href="#Shifts along principal axes">Shifts along principal axes</a></li>
              <li><a href="#Velocity structure II (post-rotation)">Velocity structure II (post-rotation)</a></li>
              <li><a href="#Rotating to position angle">Rotating to position angle</a></li>
              <li><a href="#Velocity dispersion">Velocity dispersion</a></li>
              <li><a href="#World coordinates">World coordinates</a></li>
              <li><a href="#Projection">Projection</a></li>
              <li><a href="#Gridding">Gridding</a></li>
              <li><a href="#Instrumental function">Instrumental function</a></li>
            </ul>
          </ul>
          <br>
          <ul class="par" style="list-style-type:none;padding-left:0em;margin-top:0px;margin-bottom:0px;">
            <li><a href="#Summary of parameters described here">Summary of parameters described here</a></li>
          </ul>
        </td>
      </tr>
    </table>
  </center>
</p>




<a name="Coordinate system"><h3>Coordinate system</h3></a>

<p class="par">
  The TiRiFiC coordinate system is conforming with the IAU or IEEE
  conventions (in principle for polarimetry, but also generally, see
  <a href="http://esoads.eso.org/abs/1974tiau.book.....C>here</a> and
  also <a
  href="http://esoads.eso.org/abs/1996A%26AS..117..161H">Hamaker &
  Bregman 1996</a>). The Cartesian reference system is defined with
  the first (x-) axis pointing towards North, the second (y-) axis
  pointing towards East, and the third (z-) axis pointing towards the
  observer. The reference frame in velocity is parallel to the spatial
  grid. This implies that intriniscally positive velocity differences
  along the line-of-sight imply a negative difference in recession
  velocity and vice versa. Spatial units are entered by the user in
  units of seconds of arc, velocity units are km/s, angles are entered
  in units of degrees. The appropriate sub-ring-based cylindric
  coordinate system is defined with the radius <i>R</i> (in
  arcseconds), the azimuth <i>&#966;</i> (in radians), and the height
  above the (xy-) plane <i>Z</i> (in arcseconds).  A positive
  tangential velocity is defined as a counterclockwise rotation in the
  NE (xy-) plane, a positive radial velocity outwards from the
  origin. Figures 1 and 2 reflect the TiRiFiC geometry and define the
  single reference systems.  For a face-on view prior to rotation the
  coordinate systems transform via
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="6"> (1) </td> 
         <td nowrap valign="top"> <i>x</i>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) </td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>x</i><sub>1</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>cos</i>(<i>&#966;</i>)<sup>&nbsp;</sup></td>
         <td align="left" rowspan="6" nowrap> , where </td> 
       </tr>
       <tr>
         <td nowrap valign="top"> <i>y</i>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>x</i><sub>2</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>sin</i>(<i>&#966;</i>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>z</i>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>x</i><sub>3</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>Z</i><sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sub>x</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>V</i><sub>1</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sub>R</sub><i>cos</i>(<i>&#966;</i>)-<i>V</i><sub>&#966;</sub><i>sin</i>(<i>&#966;</i>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sub>y</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>V</i><sub>2</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sub>R</sub><i>sin</i>(<i>&#966;</i>)+<i>V</i><sub>&#966;</sub><i>cos</i>(<i>&#966;</i>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sub>z</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>V</i><sub>3</sub>(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>, <i>V</i><sub>Z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sub>Z</sub><sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  <i>V</i><sub>R</sub> denotes the radial velocity
  (d<i>R</i>/d<i>t</i>, outwards positive), <i>V</i><sub>&#966;</sub>
  the tangential ("rotational") velocity (Rd<i>&#966;</i>/d<i>t</i>),
  positive counterclockwise, and <i>V</i><sub>Z</sub> the vertical
  velocity component (d<i>Z</i>/d<i>t</i>). The azimuthal angle
  <i>&phi;</i> is measured in radians and the arguments of the
  trigonometric functions are in radians. In the scope of constructing
  a model pointsource cloud, TiRiFiC follows a step-by-step
  generation- and coordinate transformation of point sources. We first
  give a quick description, which can be used as a quick reminder, and
  then a detailed one. We append a complete list of parameters at the bottom.
</p>



<a name="Model generation: quick description"><h3>Model generation: quick description</h3></a>

<a name="Radial nodes and parameter discretisationq"><h4>Radial nodes and parameter discretisation</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="NUR"><b>NUR</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Number of grid nodes (ring radii) </td>
  </tr>
  <tr>
    <td align="left"><a name="RADI"><b>RADI</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">arcsec </td>
    <td align="left">List of grid nodes (ring radii)</td>
  </tr>
  <tr>
    <td align="left"><a name="RADSEP"><b>RADSEP</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">pixel </td>
    <td align="left">Separation of sub-grids (sub-rings)</td>
  </tr>
  <tr>
    <td align="left"><a name="RADSEP_i"><b>RADSEP_i</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">pixel </td>
    <td align="left">Separation of sub-grids (sub-rings), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="INTY"><b>INTY</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Interpolation scheme for sub-grid (sub-ring) parameters; 0: linear, 1: natural cubic spline, 2: natural Akima</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Radial nodes and parameter discretisation">More Details</a></td>
  </tr>
</table>
</center>


<p class="par">
  Tirific constructs a tilted ring model of a number of disks. The
  user specifies the number of radial nodes on which the model
  parameters are defined by the user or changed during the fitting
  process with the parameter <a
  href="model_geometry.html#NUR">NUR</a> and provides a set of
  exactly NUR node positions (ring radii in arcsec) with the parameter
  <a href="model_geometry.html#RADI">RADI</a>. The first node has
  always the radius 0, but is still required to be explicitly
  specified by the user. For every disk, the nodes have the same
  values and are thus given once for all disks. All further
  radius-dependent parameters are defined by the user or are fitted at
  the given radial nodes, i.e., for a parameter PAR, the user
  specifies directly or indirectly <a
  href="model_geometry.html#NUR">NUR</a> numbers, hence defining the
  parameter PAR at each node (in the same order as <a
  href="model_geometry.html#RADI">RADI</a>). For any given
  geometrical parameter apart from <a
  href="model_geometry.html#RADI">RADI</a>, defaults are
  defined. Furtherly, the values at larger raii default to the last
  given number. Intrinsically, the parameters are calculated on small
  "sub-rings" via interpolation. The type of interpolation between the radial nodes is controled with the parameter  <a href="model_geometry.html#INTY">INTY</a>. The user has the choice between linear interpolation (<a href="model_geometry.html#INTY">INTY</a>=0, default), natural cubic spline (<a href="model_geometry.html#INTY">INTY</a>=1), and non-rounded Akima interpolation with natural boundary conditions (<a href="model_geometry.html#INTY">INTY</a>=2). Computationally, linear interpolation is the cheapest, followed by Akima, with cubic spline being the most expensive interpolation. The width and the separation
  of the subrings are identical and specified by the user using the
  parameter <a href="model_geometry.html#RADSEP">RADSEP</a>, which
  defined the width of a sub-ring in units of pixels in spatial
  direction (which are assumed to have the same spatial extent in all
  directions). With <a href="model_geometry.html#RADSEP">RADSEP</a>,
  the sub-ring separation of the first disk is fixed, with <a
  href="model_geometry.html#RADSEP_i">RADSEP_i</a> the sub-ring
  separation of consecutive disks (i = 2, 3, ...) is specified. A
  detailed description of the parameter sampling can be <a
  href="model_geometry.html#Radial nodes and parameter discretisation"> found here</a>. See also <a
  href="modelling_strategy.html#Basic model concepts">section
  modelling strategy</a>.
</p>


<a name="Quasi-random numbersq"><h4>Quasi-random numbers</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="ISEED"><b>ISEED</b></a></td>
    <td align="center">Geometrical (default 1803)</td>
    <td align="center">&nbsp; </td>
    <td align="left"> Seed for random-number generator</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Quasi-random numbers">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
TiRiFiC uses a deterministic random number generator to generate point sources. This random number generator is initialised using the parameter <a href="ISEED">ISEED</a>, which accepts values from 0 to 31328. For a given <a href="ISEED">ISEED</a>, TiRiFiC will produce the same model in two consecutive runs with the same input parameters.
</p>

              <a name="Multiple disksq"><h4>Multiple disks</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="NDISKS"><b>NDISKS</b></a></td>
    <td align="center">Geometrical </td>
    <td align="center">&nbsp; </td>
    <td align="left"> Number of disks</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Multiple disks">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
TiRiFiC allows for the definition of multiple disks. The number of disks is defined with the parameter <a href="model_geometry.html#NDISKS">NDISKS</a> and defaults to a number determined by the user at compile time. Parameters which need to be defined per disk are assigned via an underscore "_" followed by the disk number, as described for each parameter.
</p>


<a name="Face-on surface brightnessq"><h4>Face-on surface brightness</h4></a>
<p class="par">
  For each radius the user has the possibility to define a constant
  surface brightness, and large-scale (harmonic) and small scale
  distortions along a ring, as well as to omit regions along a
  ring. For a detailed mathematical description <a
  href="model_geometry#Face-on surface brightness">see here</a>.
</p>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="SBR"><b>SBR</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left"> Constant surface brightness</td>
  </tr>
  <tr>
    <td align="left"><a name="SBR_i"><b>SBR_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left"> Constant surface brightness, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Face-on surface brightness: sbr">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
For each disk the user defines the constant surface brightness in units of Jy km s<sup>-1</sup> arcsec<sup>-2</sup> at each radial node (for each ring). For the first disk this is done via the parameter <a
  href="model_geometry.html#SBR">SBR</a>, for further disks, via the parameter <a
  href="model_geometry.html#SBR_i">SBR_i</a>, where i = 2, 3, ... . The default for <a
  href="model_geometry.html#SBR">SBR</a> and <a
  href="model_geometry.html#SBR_i">SBR_i</a> is 0.
</p>

<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="SMkA"><b>SMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of harmonic surface-brightness distortion kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="SMkP"><b>SMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic surface-brightness distortion kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="SMkA_i"><b>SMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of harmonic surface-brightness distortion kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="SMkP_i"><b>SMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic surface-brightness distortion kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Face-on surface brightness: sbr">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="sbrmode0_1.th.gif" width="300"></td>
      <td width="30" align="left"><img src="sbrmodes.th.gif" width="300"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="600" height="10" align="left" colspan=2><i>Fig. 3:
      Left: surface brightness distribution of a disk model employing
      a mixture of an m = 0 and m = 1 (azimuthal) harmonics in surface
      brightness. Right: parametrisation of surface brightness. Top
      curve: (azimuthally) constant surface brightness (mode 0, SBR)
      in dependence of radius. Middle curve: amplitude of first order
      azimuthal variation (mode 1, SM1A) in dependence of
      radius. Bottom curve: phase of first order azimuthal variation
      (mode 1, SM1P) in dependence of radius.</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
In addition to the constant surface brightness, the user defines for each disk the amplitudes and phases for additional sinusoidal variations in surface brightness in dependence of the (face-on) azimuthal angle. The user defines the amplitudes via the parameters <a href="model_geometry.html#SMkA">SMkA</a> (defaulting to 0), where k = 1, ..., 4 denotes the number of maxima along a ring. For an inclination between -90&deg; and 90&deg;, the (first) maxima are shifted counterclockwise by an angle with respect to the approaching side major axis by the angles (phases) <a href="model_geometry.html#SMkP=">SMkP</a> (default: 0), where k = 1, .., 4 corresponds to the sinusoidal distortions of order 1, ..., 4. Hence, TiRiFiC enables the user of a harmonic decomposition in surface brightness up to the 4th order (<a href="model_geometry.html#SBR">SBR</a> denoting the 0th order harmonics). For further disks, the corresponding amplitudes and phases of the harmonic distortions in surface brightness are defined using the parameters <a href="model_geometry.html#SMkA_i">SMkA_i</a> and <a href="model_geometry.html#SMkP_i">SMkP_i</a>.
</p>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkA"><b>GAkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkP"><b>GAkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkD"><b>GAkD</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec</sup> </td>
    <td align="left">Dispersion of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkA_i"><b>GAkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkP_i"><b>GAkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="GAkD_i"><b>GAkD_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec</sup> </td>
    <td align="left">Dispersion of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Face-on surface brightness: gauss">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="gaussdist_sbr.th.gif" width="300"></td>
      <td width="30" align="left"><img src="gaudist.th.gif" width="300"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="600" height="10" align="left" colspan=2><i>Fig. 4:
      Left: surface brightness distribution of a disk model employing
      a mixture of a constant surface brightness distribution and a
      Gaussian distortion. Right: parametrisation of Gaussian
      distortion. Top curve: amplitude of distortion (GA1A) in
      dependence of radius. Middle curve: phase of distortion (GA1P)
      in dependence of radius. Bottom curve: dispersion of Gaussian
      (GA1D in arcsec).</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
Furtherly, the user defines Gaussian distortions along rings (in
dependence of the azimuthal angle). Per disk and ring up to 4 Gaussian
distortions can be added, with for the first disk <a
href="model_geometry.html#GAkA">GAkA</a> (k = 1, ..., 4) being the
maxima in surface brightness (default: 0), <a
href="model_geometry.html#GAkP">GAkP</a> (k = 1, ..., 4) the the
corresponding positions of the maxima in azimuth, (for inclinations
between -90&deg; and 90&deg;) with respect to the approaching side
major axis (default: 0), and <a
href="model_geometry.html#GAkD">GAkD</a> (k = 1, ..., 4) the
dispersions in units of arcsec (not degrees; default: 0). For further
disks the corresponding parameters are called <a
href="model_geometry.html#GAkA_i">GAkA_i</a>, <a
href="model_geometry.html#GAkP_i">GAkP_i</a>, and <a
href="model_geometry.html#GAkD_i">GAkD_i</a>, k = 1, ..., 4, i = 2,
3, ... .
</p>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="AZkP"><b>AZkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Central positions of modelled azimuthal range (k = 1, 2)</td>
  </tr>
  <tr>
    <td align="left"><a name="AZkW"><b>AZkW</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Width of modelled azimuthal range (k = 1, 2)</td>
  </tr>
  <tr>
    <td align="left"><a name="AZkP_i"><b>AZkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Central positions of modelled azimuthal range (k = 1, 2), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="AZkW_i"><b>AZkW_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Width of modelled azimuthal range (k = 1, 2), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Face-on surface brightness: range">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="azimodes.m0.th.gif" width="300"></td>
      <td width="30" align="left"><img src="aziranges.th.gif" width="300"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="600" height="10" align="left" colspan=2><i>Fig. 5:
      Left: surface brightness distribution of a disk model
      restricting the azimuthal range in two regions. Right:
      parametrisation of the azimuthal ranges. Top curve: position of
      first wedge. Second curve from top: width of first wedge. Second
      curve from bottom: position of second wedge. Bottom curve: width
      of second wedge.</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
Finally, the user supplies up to two (face-on) azimuthal ranges per
radial grid position (per ring radius), within which the model is
generated. For the first disk, the user specifies two azimuthal angles
<a href="model_geometry.html#AZkP">AZ1P</a> and <a
href="model_geometry.html#AZkP">AZ2P</a> and the corresponding
widths of the selected wedges <a
href="model_geometry.html#AZkP">AZ1W</a> and <a
href="model_geometry.html#AZkP">AZ2W</a>. The model will only be
generated within the selected azimuthal ranges. Origin is (for an
inclination between -90&deg; and 90&deg;) the approaching side
projected major axis of the ring in question. All parameters default
to 0. If the width of a wedge is 0 (<a
href="model_geometry.html#AZkP">AZ1W</a> and <a
href="model_geometry.html#AZkP">AZ2W</a>), then no corresponding
wedge is selected (no selection in azimuthal range takes place). For
the second, third, etc. disks, the parameters <a
href="model_geometry.html#AZkP_i">AZ1P_i</a>, <a
href="model_geometry.html#AZkP_i">AZ2P_i</a>, <a
href="model_geometry.html#AZkP_i">AZ1W_i</a>, and <a
href="model_geometry.html#AZkP_i">AZ2W_i</a> (i = 2, 3, ...) have
the same fuction. A common application of this possibility is to model
two halves of a disk with (partly) differing parametrisations. The
user defines two disks with nearly identical parameters (e.g. central
coordinates are identical) to then define AZ1P = 0, AZ1W = 180, AZ1P_2 =
180, AZ1W_2 = 180. This means that only half a disk is modelled for the
first disk (approaching side), and half a disk is modelled for the
second disk (receding side), which may be completely different, but
which may also share the same parameters (it is possible to fit a
common centre for both halves).
</p>

              <a name="Vertical density distributionq"><h4>Vertical density distribution</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="LTYPE"><b>LTYPE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> </td>
    <td align="left">Vertical density distribution: 0: constant, 1: Gaussian, 2: sech<sup>2</sup>, 3: exponential, 4: Lorentzian </td>
  </tr>
  <tr>
    <td align="left"><a name="Z0"><b>Z0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Thickness of disk</td>
  </tr>
  <tr>
    <td align="left"><a name="LTYPE_i"><b>LTYPE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> </td>
    <td align="left">Vertical density distribution: 0: constant, 1: Gaussian, 2: sech<sup>2</sup>, 3: exponential, 4: Lorentzian, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a name="Z0_i"><b>Z0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Thickness of disk, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Vertical density distribution">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
In  a next step, to characterise the disk thickness, the user defines a scale law with the parameter <a
href="model_geometry.html#LTYPE">LTYPE</a> and the thickness of the first disk following that scale law with the parameter <a
href="model_geometry.html#Z0">Z0</a> (in arcsec). The detailed functional forms of the scale laws can be <a href="model_geometry.html#Vertical density distribution">found here</a>. For every further disk, the corresponding quantities are specified with the parameters <a
href="model_geometry.html#LTYPE_i">LTYPE_i</a> and <a
href="model_geometry.html#Z0_i">Z0_i</a> (i = 2, 3, ...).
</p>

              <a name="Velocity structure Iq"><h4>Velocity structure I</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="VROT"><b>VROT</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Mid-plane Rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="ROkA"><b>ROkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), first disk</td>
  </tr>
  <tr>
    <td align="left"><a name="ROkP"><b>ROkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), first disk</td>
  <tr>
    <td align="left"><a name="DVRO"><b>DVRO</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of rotation velocity </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDRO"><b>ZDRO</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VRAD"><b>VRAD</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane radial velocity (outwards positive)</td>
  </tr>
  <tr>
    <td align="left"><a name="RAkA"><b>RAkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic radial velocity kth order (k = 1, ..., 4), first disk</td>
  </tr>
  <tr>
    <td align="left"><a name="RAkP"><b>RAkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic radial velocity kth order (k = 1, ..., 4), first disk</td>
  <tr>
  <tr>
    <td align="left"><a name="DVRA"><b>DVRA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of radial velocity </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDRA"><b>ZDRA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in radial velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VVER"><b>VVER</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane vertical velocity  </td>
  </tr>
  <tr>
    <td align="left"><a name="DVVE"><b>DVVE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of vertical velocity  </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDVE"><b>ZDVE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in vertical velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VROT_i"><b>VROT_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Mid-plane Rotation velocity, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="ROkA_i"><b>ROkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="ROkP_i"><b>ROkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="DVRO_i"><b>DVRO_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of rotation velocity, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDRO_i"><b>ZDRO_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VRAD_i"><b>VRAD_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane radial velocity (outwards positive), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="RAkA_i"><b>RAkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic radial velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="RAkP_i"><b>RAkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic radial velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="DVRA_i"><b>DVRA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of radial velocity, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDRA_i"><b>ZDRA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in radial velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VVER_i"><b>VVER_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane vertical velocity, ith disk, i = 2, 3, ...  </td>
  </tr>
  <tr>
    <td align="left"><a name="DVVE_i"><b>DVVE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of vertical velocity, ith disk, i = 2, 3, ...  </td>
  </tr>
  <tr>
    <td align="left"><a name="ZDVE_i"><b>ZDVE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in vertical velocity</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Velocity structure I">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="900" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="radial_vfield.gif" height="200"></td>
      <td width="30" align="left"><img src="PV_vrot_gradient.gif" height="200"></td>
      <td width="30" align="left"><img src="PV_vertical_motion.gif" height="200"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td colspan="3" height="10" align="left" colspan=2><i>Fig. 6:
      Signatures of a noncircular velocity structure, as can be
      constructed with TiRiFiC Left: Velocity field of a rotating disk
      with additional radial motion. The typical signature is a tilt
      of the isovelocity contours with respect to the geometrical
      principal axes. Middle: Positon-velocity diagram along the major
      axis (blue line in left image) for a thick disk with a vertical
      gradient in rotation velocity (pink) compared to a
      position-velocity diagram without the gradient (blue). Right:
      Positon-velocity diagram along the major axis (blue line in left
      image) for a thick disk with a vertical velocity component
      (pink) compared to a position-velocity diagram without vertical
      motion (blue).</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
The user defines the velocity structure of the disk by assigning a rotation velocity <a href="model_geometry.html#VROT">VROT</a>, its azimuthal harmonics up to 4th order (k = 1, ..., 4) via amplitudes <a href="model_geometry.html#ROkA">ROkA</a> and phases <a href="model_geometry.html#ROkP">ROkP</a>, a radial velocity <a href="model_geometry.html#VRAD">VRAD</a>, , its azimuthal harmonics up to 4th order (k = 1, ..., 4) via amplitudes <a href="model_geometry.html#ROkA">RAkA</a> and phases <a href="model_geometry.html#ROkP">RAkP</a>, and a vertical velocity <a href="model_geometry.html#VVER">VVER</a> (perpendicular to the disk) in the central plane of the disk, and gradients of <a href="model_geometry.html#VROT">VROT</a>, <a href="model_geometry.html#VRAD">VRAD</a>, and <a href="model_geometry.html#VVER">VVER</a> (linear terms): <a href="model_geometry.html#DVRO">DVRO</a>, <a href="model_geometry.html#DVRA">DVRA</a>, and <a href="model_geometry.html#DVVE">DVVE</a>. In addition onset heights above the plane <a href="model_geometry.html#DVRO">ZDRO</a>, <a href="model_geometry.html#ZDRA">ZDRA</a>, and <a href="model_geometry.html#ZDVE">ZDVE</a> can be defined. Until the given onset heights are reached, the single velocities stay constant with height above the mid-plane, and start to decrease linearly with the given gradients with increasing height above the mid-plane. The quantities are given for each disk, with the disk number assigned by adding an _i to the parameter, i = 2, 3, ... .
</p>
<p class="par">
In the most common application, a simple tilted-ring model, the user will choose all velocity paramters to be zero (i.e. ignore them completely), except for <a href="model_geometry.html#VROT">VROT</a>, the rotation velocity. Less common applications will probably include a radial component <a href="model_geometry.html#VROT">VRAD</a>, as well as second-order harmonics <a href="model_geometry.html#ROkA">RO2A</a>, <a href="model_geometry.html#ROkP">RO2P</a>, <a href="model_geometry.html#RAkA">RA2A</a>, and <a href="model_geometry.html#ROkP">RA2P</a> to implement simplified bar streaming using the prescription of <a href="http://adsabs.harvard.edu/abs/2007ApJ...664..204S">Spekkens & Sellwood (2007)</a>, as realised in the <a href="http://www.physics.rutgers.edu/~spekkens/diskfit/">diskfit</a> velocity field (and total-intensity) analysis software (see also <a href="http://irs.ub.rug.nl/ppn/183679792">Schoenmakers (1999)</a>), as in detail described <a href="model_geometry.html#Velocity structure I">below</a>.
</p>
              <a name="Vertical harmonic distortionsq"><h4>Vertical harmonic distortions</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="WM0A"><b>WM0A</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement 0th order: constant vertical displacement</td>
  </tr>
  <tr>
    <td align="left"><a name="WMkA"><b>WMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="WMkP"><b>WMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic vertical displacement kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="WM0A_i"><b>WM0A_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement 0th order: constant vertical displacement, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="WMkA_i"><b>WMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="WMkP_i"><b>WMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic vertical displacement kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Vertical harmonic distortions">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="right" width="300" border="0" cellpadding="0">
    <tr>
      <td>&nbsp;&nbsp;</td>
<td width="30" align="left"><img src="m0warpstr.gif" width="300"></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
<td width="30" align="left"><img src="m1warpstr.gif" width="300"></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
<td width="30" align="left"><img src="m2warpstr.gif" width="300"></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>       
        <td width="300" height="10" align="left" colspan=2><i>Fig. 8:
        Harmonical decomposition of vertical distortions. A vertical
        shift in dependence of the azimuthal angle <i>&#966;</i> can
        be decomposed into a Fourier series, the first orders of which
        can be reconstructed to approximate the vertical excursions of
        a disk. The result is a sum of modes as shown here (from top
        to bottom 0th order, 1st order, 2nd order).</i></td>
    </tr>
  </table>
</p>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="warpmode_par.gif" width="300"></td>
      <td width="30" align="left"><img src="warpmode_m0.gif" width="150"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="900" height="10" align="left" colspan=2><i>Fig. 7:
      Parametrisation of two warp modes. The resulting total intensity
      map shows a mixture of an m=0 mode (Fourier component of 0th
      order) and an m=1 mode (Fourier component 1st order) and appears
      asymmetric (as real disks quite commonly do).</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
The user defines in a next step a vertical displacement with the possibility to construct warps of a complex geometry. The user defines for each disk the amplitudes and phases for additional sinusoidal variations in height above the plane in dependence of the (face-on) azimuthal angle. The user defines the amplitudes via the parameters <a href="model_geometry.html#WMkA">WMkA</a> (defaulting to 0), where k = 1, ..., 4 denotes the number of maxima along a ring. For an inclination between -90&deg; and 90&deg;, the (first) maxima are shifted counterclockwise by an angle with respect to the approaching side major axis by the angles (phases) <a href="model_geometry.html#WMkP">WMkP</a> (default: 0), where k = 1, .., 4 corresponds to the sinusoidal distortions of order 1, ..., 4. Hence, TiRiFiC enables the user of a harmonic decomposition of the height above a principal plane up to the 4th order (<a href="model_geometry.html#WM0A">WM0A</a> denoting the 0th order harmonics or constant displacement). For further disks, the corresponding amplitudes and phases of the harmonic distortions in height above the plane are defined using the parameters <a href="model_geometry.html#WMkA_i">WMkA_i</a> and <a href="model_geometry.html#WMkP_i">WMkP_i</a> (i = 2, 3, ...).
</p>
              <a name="Tilting to inclinationq"><h4>Tilting to inclination</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="INCL"><b>INCL</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination</td>
  </tr>
  <tr>
    <td align="left"><a name="INCL_i"><b>INCL_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Tilting to inclination">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
In a next step, the first model disk is tilted by the angle <a
href="model_geometry.html#INCL">INCL</a> about the x-axis (pointing to the North), further disks are tilted by the angles <a
href="model_geometry.html#INCL_i">INCL_i</a>, i = 2, 3, ... .
</p>
              <a name="Shifts along principal axesq"><h4>Shifts along principal axes</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="LC0"><b>LC0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected major axis</td>
  </tr>
  <tr>
    <td align="left"><a name="LS0"><b>LS0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected minor axis</td>
  </tr>
  <tr>
    <td align="left"><a name="LC0_i"><b>LC0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected major axis, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="LS0_i"><b>LS0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected minor axis, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Shifts along principal axes">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="lc0par.gif" width="300"></td>
      <td width="30" align="left"><img src="lc0mom0.gif" width="150"></td>
      <td width="30" align="left"><img src="lc0pv.gif" width="450"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="900" height="10" align="left" colspan="3"><i>Fig. 9:
      Applying a shift along the projected major axis. Left:
      Parametrisation including a shift along the major axis
      (parameter LC0). Middle: Correspondig "lopsided" appearance of
      the total intensity. Right: Corresponding position-velocity
      diagram along the blue line in the middle panel.</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
In a next step, the first model disk is shifted by <a
href="model_geometry.html#LC0">LC0</a> arcsec in the direction of the major axis of the projected ring and by <a
href="model_geometry.html#LS0">LS0</a> arcsec in the direction of the minor axis of the projected ring. about the x-axis (pointing to the North), further disks are shifted by <a
href="model_geometry.html#LC0_i">LC0_i</a> and<a
href="model_geometry.html#LS0_i">LS0_i</a> (arcsec), i = 2, 3, ... .
</p>
              <a name="Velocity structure II (post-rotation)q"><h4>Velocity structure II (post-rotation)</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="VM0A"><b>VM0A</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity 0th order: constant shift in velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VMkA"><b>VMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="VMkP"><b>VMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="VM0A_i"><b>VM0A_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity 0th order: constant shift in velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="VMkA_i"><b>VMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a name="VMkP_i"><b>VMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Velocity structure II (post-rotation)">More Details</a></td>
  </tr>
</table>
</center>
<p>
  <table align="center" width="600" border="0" cellpadding="0">
    <tr>
      <td width="30" align="left"><img src="velm2.th.gif" width="300"></td>
      <td width="30" align="left"><img src="velm2m0.th.gif" width="300"></td>
      <td width="30" align="left"><img src="velm2vf.th.gif" width="300"></td>
      <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
      <td width="900" height="10" align="left" colspan="3"><i>Fig. 10:
      Line-of-sight velocity harmonics. Left: Parametrisation
      including a second-order harmonic term in the line-of-sight
      velocity (parameters amplitude VM2A and phase VM2P). Middle: A
      face-on-disk was constructed, the image shows the
      total-intensity map. Right: Velocity field resulting from the
      m=2 mode only (since the disk is face-on).</i></td>
    </tr>
    <tr>
      <td>&nbsp;&nbsp;</td>
    </tr>
  </table>
</p>
<p class="par">
The user defines for each disk the amplitudes and phases for additional sinusoidal variations of the velocity along the line-of-sight (LOS) <i>after</i> tilting to inclination in dependence of the (face-on) azimuthal angle (this way even a face-on ring can have a velocity signature, e.g. showing precession). The user defines the amplitudes via the parameters <a href="model_geometry.html#VMkA">VMkA</a> (defaulting to 0), where k = 0, 1, ..., 4 denotes the number of maxima along a ring. For an inclination between -90&deg; and 90&deg;, the (first) maxima are shifted counterclockwise by an angle with respect to the approaching side major axis by the angles (phases) <a href="model_geometry.html#VMkP">VMkP</a> (default: 0), where k = 1, .., 4 corresponds to the sinusoidal distortions of order 1, ..., 4. Hence, TiRiFiC enables the user of a harmonic decomposition of the line-of-sight velocity up to the 4th order (<a href="model_geometry.html#VM0A">VM0A</a> denoting the 0th order harmonics or constant displacement). For further disks, the corresponding amplitudes and phases of the harmonic distortions in velocity are defined using the parameters <a href="model_geometry.html#VMkA_i">VMkA_i</a> and <a href="model_geometry.html#VMkP_i">VMkP_i</a> (i = 2, 3, ...). Notice that a positive change of the velocity in the intrinsic coordinate system (z-axis pointing towards the observer, which above parameters relate to) corresponds to a decrease in the measured line-of-sight velocity.
</p>

              <a name="Rotating to position angleq"><h4>Rotating to position angle</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="PA"><b>PA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination</td>
  </tr>
  <tr>
    <td align="left"><a name="PA_i"><b>PA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Rotating to position angle">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
In a next step, the first model disk is rotated by the angle <a
href="model_geometry.html#PA">PA</a> + 180&deg; about the z-axis (pointing towards the observer), further disks are tilted by the angles <a
href="model_geometry.html#PA_i">PA_i</a> + 180&deg;, i = 2, 3, ... . Note that the rotation takes place after applying shifts along principal axes. By adding 180&deg; to the position angle before rotation, the definition of the position angle conforms to the common <a
      href="http://www.astro.rug.nl/~gipsy/">GIPSY</a> definition (where the position angle describes the angle between the axis pointing to the North and the receding half major axis of the projected orbits).
</p>

              <a name="Velocity dispersionq"><h4>Velocity dispersion</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="SDIS"><b>SDIS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Radially dependent velocity dispersion</td>
  </tr>
  <tr>
    <td align="left"><a name="CLNR"><b>CLNR</b></a></td>
    <td align="center">Geometrical (default 1)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Number of sub-clouds per cloud</td>
  </tr>
  <tr>
    <td align="left"><a name="SDIS_i"><b>SDIS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Radially dependent velocity dispersion, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="CLNR_i"><b>CLNR_i</b></a></td>
    <td align="center">Geometrical (default 1)</td>
    <td align="center"> </td>
    <td align="left">Number of sub-clouds per cloud, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Velocity dispersion">More Details</a></td>
  </tr>
</table>
</center>
<p class="par">
An isotropic Gaussian velocity spread with dispersion <a
href="model_geometry.html#SDIS">SDIS</a>, varying with radius, can be added to the model. Intrinsically, a Gaussian random component is added to the line-of-sight velocity of each modelled point source. As with the <a
      href="http://www.astro.rug.nl/~gipsy/">GIPSY</a> task <a
  href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>, it is possible to split a cloud into <a
href="model_geometry.html#CLNR">CLNR</a> sub-clouds, differing only in the added random component, such that a smoother model is achieved without the expanse of unnecessary computing power. It is recommended to choose <a
href="model_geometry.html#CLNR">CLNR</a> to be larger than 1 (values of 3, 5, 10 have been successfully used). For disks other than the first one, the corresponding parameters are called <a
href="model_geometry.html#SDIS_i">SDIS_i</a> and <a
href="model_geometry.html#CLNR_i">CLNR_i</a> (i = 2, 3, ...). As <a href="model_geometry.html#Velocity dispersion">described here</a>, an anisotropic velocity dispersion can be implemented into TiRiFiC quite easily, but we do this only <a href="mailto:jozsa@ska.ac.za">on request</a>. Do not hesitate.
</p>

              <a name="World coordinatesq"><h4>World coordinates</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="XPOS"><b>XPOS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Right ascension</td>
  </tr>
  <tr>
    <td align="left"><a name="YPOS"><b>YPOS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">declination</td>
  </tr>
  <tr>
    <td align="left"><a name="VSYS"><b>VSYS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Recession velocity</td>
  </tr>
  <tr>
    <td align="left"><a name="XPOS_i"><b>XPOS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Right ascension, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="YPOS_i"><b>YPOS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Declination, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a name="VSYS_i"><b>VSYS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Recession velocity, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#World coordinates">More details</a></td>
  </tr>
</table>
</center>
<p class="par">
With the parameter <a
href="model_geometry.html#XPOS">XPOS</a> the user specifies the right ascension of the origin of the coordinate system at a specific radius, with  the parameter <a
href="model_geometry.html#YPOS">YPOS</a> its declination, and with the parameter <a
href="model_geometry.html#XPOS">VSYS</a> its velocity. All three parameters are measured in the reference system of the input data cube and may change with radius. For further disks, the corresponding parameters are called 
<a href="model_geometry.html#XPOS_i">XPOS_i</a>,
<a href="model_geometry.html#YPOS_i">YPOS_i</a>, and
<a href="model_geometry.html#XPOS_i">VSYS_</a> with i = 2, 3, ... being the disk number.
</p>
              <a name="Projectionq"><h4>Projection</h4></a>
<p class="par">
TiRiFiC produces a 6D model, which is projected onto the 3D data cube. For that, TiRiFiC assumes that a parallel projection is sufficient for the studied objects (<a href="model_geometry.html#Projection">more details</a>).
</p>

              <a name="Griddingq"><h4>Gridding</h4></a>
<p class="par">
TiRiFiC uses the nearest pixel method to grid a cloud of point sources onto the data cube. Mathematically, this is equivalent to a convolution by a rectangle function, as has already been pointed out in the description of the <a
      href="http://www.astro.rug.nl/~gipsy/">GIPSY</a> task <a
  href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>. The detailed mathematical formulation can be <a href="model_geometry.html#Gridding">found here</a>. Notice that TiRiFiC does not automatically correct for the small connected effect by reducing the artificial observational beam.
</p>

              <a name="Instrumental functionq"><h4>Instrumental function</h4></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr>
    <td align="center">Name</td>
    <td align="center">Category</td>
    <td align="center">Unit</td>
    <td align="center">Description</td>
  </tr>
  <tr>
    <td align="left"><a name="BMAJ"><b>BMAJ</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">arcsec </td>
    <td align="left">Observational beam HPBW, major axis</td>
  </tr>
  <tr>
    <td align="left"><a name="BMIN"><b>BMIN</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">arcsec </td>
    <td align="left">Observational beam HPBW, minor axis</td>
  </tr>
  <tr>
    <td align="left"><a name="BPA"><b>BPA</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">degrees </td>
    <td align="left">Position angle of observational beam major axis, measured anticlockwise from N</td>
  </tr>
  <tr>
    <td align="left"><a name="CONDISP"><b>CONDISP</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Global velocity dispersion</td>
  </tr>
  <tr>
    <td align="center" colspan="4"><a href="model_geometry.html#Instrumental function">More details</a></td>
  </tr>
</table>
</center>
<p class="par">
Before a data cube is written to disk or compared with an input data cube, the observational function is applied <i>after gridding</i> by convolving the data cube with a representative 3D Gaussian, making use of a Fast Fourier Transform. In the spatial domain, the user provides the major and minor axis half-power-beam-widths (HPBW) <a href="model_geometry.html#BMAJ">BMAJ</a> and <a href="model_geometry.html#BMIN">BMIN</a> of the observational beam (point-spread function), together with the position angle <a href="model_geometry.html#BPA">BPA</a> of the beam major axis, measured with respect to the North. In the velocity domain, a global dispersion <a href="model_geometry.html#CONDISP">CONDISP</a> is provided by the user or changed during the fitting process. Please notice that the global velocity dispersion can be used to simulate a globally constant velocity dispersion of the simulated disk that mixes with the instrumental velocity dispersion (<i>&sigma;</i><sup>2</sup><sub>v,global</sub> = <i>&sigma;</i><sup>2</sup><sub>v, instrumental</sub> + <i>&sigma;</i><sup>2</sup><sub>v, internal</sub>). The fact that the observation is simulated after gridding, however, introduces (really) small errors, which can be suppressed by either decreasing the sizes of the voxels or by making use of the parameter <a href="model_geometry.html#SDIS">SDIS</a>. Again, we emphasise that the beam size is not corrected for the fact that the <a href="Griddingq">gridding</a> method used by TiRiFiC is equivalent to a convolution with a rectangle function. Also here, the error is usually very limited. See also <a href="model_geometry.html#Instrumental function">detailed description below</a> and alternative description on the page <a href="modelling_strategy.html#BMAJ">Modelling Strategy</a>.
</p>



<a name="Model generation: detailed description"><h3>Model generation: detailed description</h3></a>



<a name="Radial nodes and parameter discretisation"><h4>Radial nodes and parameter discretisation</h4></a>

<p class="par">
  As already discussed <a href="modelling_strategy.html#Basic model
  concepts">here</a>, with the parameter RADI, the user supplies a set
  of "radial" nodes {RADI<sub>j</sub>}<sub>j = 1,...,n</sub> or "ring
  radii" in units of arcsec, with
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="2"> (2) </td> 
         <td nowrap valign="top">  RADI<sub>1</sub> <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> 0 <sup>&nbsp;</sup></td>
         <td align="left" rowspan="2" nowrap>,</td> 
       </tr>
       <tr>
         <td> RADI<sub>j</sub>&nbsp <sup>&nbsp;</sup></td> 
         <td valign="top"> < <sup>&nbsp;</sup></td>
         <td valign="top"> RADI<sub>j+1</sub> <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  together with the constant "width" of "sub-rings" <a
  href="modelling_strategy.html#RADSEP">RADSEP</a> (currently in
  units of pixels). Each parameter PAR of the model discussed below is
  defined by the user (or changed during the fitting process) at the specified nodes (with a default if the
  user does not supply the parameter expressively), thus resulting in
  a set of discrete values {PAR(RADI<sub>j</sub>)}<sub>j =
  1,...,m</sub> provided by the user or changed during the fitting
  process. Intrinsically, for the calculation of a model phase-space luminosity-density <i>j</i>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) and with that, the model intensity <i>I</i>(<i>x</i>, <i>y</i>, <i>V</i><sub>z</sub>), these are converted into a set of n =
  &lceil; RADI<sub>n</sub>&middot;RADSEP<sup>-1</sup> &rceil;
  (&lceil; <i>x</i> &rceil; &hArr; <i>ceil</i>(<i>x</i>) &hArr; "round up" x) parameters defined on
  equally-spaced "radii" RD<sub>i</sub> of "sub-rings", calculated via 
  interpolation. This means that the (quasi-) continuous parameter
  RADI is discretised into a set {RD<sub>i</sub>}<sub>i =
  1,...,n</sub>, with
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="3"> (3) </td> 
         <td nowrap valign="top"> RD<sub>1</sub> <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> RADSEP/2 <sup>&nbsp;</sup></td>
         <td align="left" rowspan="3" nowrap>.</td> 
       </tr>
      <tr>
         <td nowrap valign="top">  RD<sub>i+1</sub> <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> RD<sub>i</sub>+RADSEP <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>
<!-- 
        <p>
          <center>
            <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
               <tr>
                 <td align="left" rowspan="3"> (x) </td> 
                 <td nowrap valign="top"> i < j <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> RD<sub>i</sub> < RD<sub>j</sub> <sup>&nbsp;</sup></td>
                 <td align="left" rowspan="3" nowrap>, where</td> 
               </tr>
               <tr>
                 <td nowrap valign="top"> RADI &isin; &real; <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> RD<sub>i</sub> < RD<sub>j</sub> <sup>&nbsp;</sup></td>
               </tr>
               <tr>
                 <td nowrap valign="top">  RD<sub>i</sub>(RADI) <sup>&nbsp;</sup></td> 
                 <td valign="top" > = <sup>&nbsp;</sup></td> 
                 <td valign="top"> &Sigma;<sub>k = 1,...,m</sub>&Pi;(RADI&middot;RADSEP<sup>-1</sup>-(2k+1)/2)&middot;(2k+1/2)&middot;RADSEP <sup>&nbsp;</sup></td>
               </tr>
            </table>
          </center>
        </p>
        <p>
          <center>
            <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
               <tr>
                 <td align="left" rowspan="2"> (x) </td> 
                 <td nowrap valign="top">  -1/2 &le; x < 1/2 <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> &Pi;  = 1<sup>&nbsp;</sup></td>
                 <td align="left" rowspan="2" nowrap>. and</td> 
               </tr>
               <tr>
                 <td nowrap valign="top">  x < -1/2 &or; x &ge; 1/2 <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> &Pi;  = 0<sup>&nbsp;</sup></td>
               </tr>
            </table>
          </center>
        </p>
-->

<p class="par">
The user-supplied parameters {PAR(RADI<sub>j</sub>)}<sub>j = 1, ..., m</sub> are interpolated for each sub-ring at the radius RD<sub>i</sub>. The type of interpolation between the radial nodes is controled with the parameter  <a href="model_geometry.html#INTY">INTY</a>. The user has the choice between linear interpolation (<a href="model_geometry.html#INTY">INTY</a>=0, default), natural cubic spline (<a href="model_geometry.html#INTY">INTY</a>=1), and non-rounded Akima interpolation with natural boundary conditions (<a href="model_geometry.html#INTY">INTY</a>=2). Computationally, linear interpolation is the cheapest, followed by Akima, with cubic spline being the most expensive interpolation scheme. We use the interpolation algorithms of the <a href="http://www.gnu.org/s/gsl/">GNU scientific library (GSL)</a> and refer to those www pages for details.
</p>


<p class="par">
As discussed below, the resulting model <i>j</i>(<i>x</i>,
<i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>,
<i>V</i><sub>z</sub>), from which the synthetically observed model intensity
<i>I</i>(<i>x</i>, <i>y</i>, <i>V</i><sub>z</sub>) is derived, is the discrete sum
of sub-ring models <i>j</i>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>,
<i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>,
<i>V</i><sub>z</sub>), parametrised with
the interpolated parameters at the discrete sub-ring radii.
        <p>
          <center>
            <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
               <tr>
                 <td align="left" rowspan="2"> (4) </td> 
                 <td nowrap valign="top">  <i>j</i>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td> 
                 <td valign="top" > = <sup>&nbsp;</sup></td> 
                 <td valign="top">  &Sigma;<sub>i = 1, ..., n</sub> <i>j</i>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
                 <td align="left" rowspan="2" nowrap>.</td> 
               </tr>
               <tr>
                 <td nowrap valign="top">  <sup>&nbsp;</sup></td> 
                 <td valign="top" > = <sup>&nbsp;</sup></td> 
                 <td valign="top">  &Sigma;<sub>i = 1, ..., n</sub> <i>j</i>(PAR1(RD<sub>i</sub>), PAR2(RD<sub>i</sub>), ...)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
               </tr>
            </table>
          </center>
        </p>
<p class="par">
In the
limit RADSEP &rarr; 0, the model becomes continuous in the parameter RADI. The reason for
the discretised approach is to optimise computational efficiency. A treatment without the
usage of sub-rings would increase the computing time substantially. Again, one thing to bear in mind is that TiRiFiC provides a true tilted-ring model (in that parameters like the orientational parameters inclination and position angle are kept constant) only at the level of sub-rings. 
</p>
<!-- 
        In the following we use the abbrevation 
        <p>
          <center>
            <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
               <tr>
                 <td align="left" rowspan="1"> (5) </td> 
                 <td nowrap valign="top">  <i>R</i><sub>i</sub></td> 
                 <td valign="top" > = <sup>&nbsp;</sup></td> 
                 <td valign="top"> <i>R</i><sub>i</sub>(<i>R</i>) <sup>&nbsp;</sup></td>
                 <td align="left" rowspan="1" nowrap>.</td> 
               </tr>
            </table>
          </center>
        </p>
-->


<a name="Quasi-random numbers"><h4>Quasi-random numbers</h4></a>
<p class="par">
TiRiFiC uses a quasi-random number generator to determine the positions of point sources. While the random number generator is used in several places, TiRiFiC uses only one initialisation number, given with the parameter <a href=model_geometry.html#ISEED">ISEED</a>. The implemented random number generator is an adopted version of a random generator appearing in the library <a href="http://paulbourke.net/miscellaneous/random/">randomlib</a> by <a href="http://paulbourke.net/">Paul Bourke</a>, which in turn "originally appeared in Toward a Universal Random Number Generator by George Marsaglia and Arif Zaman. Florida State University Report: FSU-SCRI-87-50 (1987) It was later modified by F. James and published in A Review of Pseudo- random Number Generators". The usage of this reliable random-number generator enables TiRiFiC the generation of 31329 random realisations of the same model, which is considered a sufficiently high number.
</p>

<a name="Multiple disks"><h4>Multiple disks</h4></a>
<p class="par">
On demand, TiRiFiC supplies a model consisting of multiple disks. The number of disks is determined by the parameter <a href="model_geometry.html#NDISKS">NDISKS</a> and defaults to a number determined at compile time. The geometrical parameters per disk are specified using parameter names PAR(RD<sub>i</sub>), from the second disk on with an index correspondind to the disk number added to the parameter name PAR_i i = 2,3,... . Excluded are the global parameters <a href="model_geometry.html#RADI">RADI</a>, <a href="model_geometry.html#RADSEP">RADSEP</a>, <a href="model_geometry.html#BMAJ">BMAJ</a>, <a href="model_geometry.html#BMIN">BMIN</a>, <a href="model_geometry.html#BPA">BPA</a>, <a href="model_geometry.html#CONDISP">CONDISP</a>, which are valid for all disks.
<p>


<a name="Face-on surface brightness"><h4>Face-on surface brightness</h4></a>
<p class="par">
<a name="Face-on surface brightness: sbr">
  In </a> a first step, sets of point sources are distributed over
  face-on sub-rings. For this, the
  azimuthal angles in the reference system of a face-on ring and the
  radii for each point source are drawn from a random distribution
  determined by the local surface brightness
  <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&phi;</i>). The absolute values of
  total fluxes of the single point sources are nearly identical
  (changed such that the total flux per sub-ring as provided by the user is
  conserved) and the point source total fluxes differ in the
  signum. First, the user specifies the amplitudes and phases
  of azimuthal harmonics in surface-brightness up to the fourth
  order. The surface brightness
  <i>B</i><sub>1</sub>)(RD<sub>i</sub>)(<i>R</i>, <i>&phi;</i>) is allowed
  to vary with the azimuthal angle, following the rule
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="2"> (5) </td> 
         <td nowrap valign="top">  RD<sub>i</sub>-RADSEP/2 &le;  <i>R</i> < RD<sub>i</sub>+RADSEP/2 <sup>&nbsp;</sup></td> 
         <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
         <td nowrap valign="top">  <i>B</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top">  SBR(RD<sub>i</sub>)+&Sigma;<sub>k = 1,...,4</sub> SMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&middot;(<i>&phi;</i>-&pi;&middot;SMkP(RD<sub>i</sub>)/180&#176;)) <sup>&nbsp;</sup></td>
         <td align="left" rowspan="2" nowrap>, where </td> 
       </tr>
       <tr>
         <td nowrap valign="top">  <i>R</i> < RD<sub>i</sub>-RADSEP/2 &or; RD<sub>i</sub>+RADSEP/2 &le; <i>R</i> <sup>&nbsp;</sup></td> 
         <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
         <td nowrap valign="top">  <i>B</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top">  0 <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  the trigonometric functions
  are defined with radians as argument. Thus, in a first step, the
  TiRiFiC surface brightness is represented by harmonics
  in azimuth up to the 4th
  order. SBR(RD<sub>i</sub>) is the amplitude of zeroth order (in Jy km s<sup>-1</sup> arcsec<sup>-2</sup>),
  SMkA(RD<sub>i</sub>) are the amplitudes of higer order (k = 1,
  ..., 4, in units of Jy km s<sup>-1</sup> arcsec<sup>-2</sup>) and SMkP(RD<sub>i</sub>) the phases in degrees. It is of course
  possible to neglect complete modes (orders) or to use the zeroth
  order only, which is the only possibility in <a
  href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>. For
  each disk such a (restricted) harmonic representation is possible.
</p>


<p class="par">
  <a name="Face-on surface brightness: gauss">Similarly,</a> local distortions (as opposed to global modes) are
  generated in a next step. Up to four Gaussian distortions (k =
  1,...,4) are added to (or subtracted from) the face-on ring, with the
  user specifying the amplitude of the distortion
  GAkA(RD<sub>i</sub>) (in Jy km s<sup>-1</sup> arcsec<sup>-2</sup>), the phase- or the azimuthal angle of the
  maximum of the distortion GAkP(RD<sub>i</sub>) (in degrees), and the
  dispersion of the Gaussian distortion along the arc
  GAkD(RD<sub>i</sub>) (in arcsec):
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="2"> (6) </td> 
         <td nowrap valign="top">  RD<sub>i</sub>-RADSEP/2 &le;  <i>R</i> < RD<sub>i</sub>+RADSEP/2 <sup>&nbsp;</sup></td> 
         <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
         <td nowrap valign="top">  <i>B</i><sub>2</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top">  &#931;<sub>k = 1,...,4</sub> GAkA(RD<sub>i</sub>)&#183;<i>exp</i>(-(<i>&#966;</i> - &pi;&middot;GAkP(RD<sub>i</sub>)/180&#176;)<sup>2</sup>/(2&#183GAkD<sup>2</sup>(RD<sub>i</sub>)RD<sup>-2</sup><sub>i</sub>)) <sup>&nbsp;</sup></td>
         <td align="left" rowspan="2" nowrap>, where </td> 
       </tr>
       <tr>
         <td nowrap valign="top">  <i>R</i> < RD<sub>i</sub>-RADSEP/2 &or; RD<sub>i</sub>+RADSEP/2 &le; <i>R</i> <sup>&nbsp;</sup></td> 
         <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
         <td nowrap valign="top">  <i>B</i><sub>2</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top">  0 <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>
<!--
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="3"> (x) </td> 
         <td nowrap valign="top">  <i>B</i><sub>2</sub>(<i>R</i>, <i>&#966;</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>B</i><sub>2</sub>(<i>R</i><sub>i</sub>, <i>&#966;</i>)<sup>&nbsp;</sup></td>
         <td align="left" rowspan="3" nowrap>. </td> 
       </tr>
       <tr>
         <td nowrap valign="top">  <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>B</i><sub>2</sub>(GA1A(<i>R</i><sub>i</sub>), GA1P(<i>R</i><sub>i</sub>), GA1D(<i>R</i><sub>i</sub>), GA2A(<i>R</i><sub>i</sub>), GA2P(<i>R</i><sub>i</sub>), GA2D(<i>R</i><sub>i</sub>), GA3A(<i>R</i><sub>i</sub>), GA3P(<i>R</i><sub>i</sub>), GA3D(<i>R</i><sub>i</sub>), GA4A(<i>R</i><sub>i</sub>), GA4P(<i>R</i><sub>i</sub>), GA4AD(<i>R</i><sub>i</sub>), <i>&#966;</i>) <sup>&nbsp;</sup></td>
      </tr>
       <tr>
         <td> &nbsp </td> 
         <td valign="top"> = <sup>&nbsp;</sup></td>
         <td valign="top"> &#931;<sub>k = 1,...,4</sub> GAkA(<i>R</i><sub>i</sub>)&#183;<i>exp</i>(-(<i>&#966;</i> - &pi;&middot;GAkP(<i>R</i><sub>i</sub>)/180&#176;)<sup>2</sup>/(2&#183GAkD<sup>2</sup>(<i>R</i><sub>i</sub>)<i>R</i><sup>-2</sup><sub>i</sub>)) <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>
-->

<p class="par">
    <a name="Face-on surface brightness: range">As</a> a last step in the initial Monte-Carlo integration, the generated
  point sources are (de-)selected depending on the azimuthal range
  they reside in. The user can select two central azimuthal angles
  ("phases" AZ1P(RD<sub>i</sub>) and AZ2P(RD<sub>i</sub>))
  and for each of those a width of the selected wedge
  (AZ1W(RD<sub>i</sub>) and AZ2W(RD<sub>i</sub>)). All
      point sources outside those wedges (the user can also decide to make use of only one wedge or no wedge) are de-selected. The
  mathematically exact formulation looks only a wee bit more
  complicated. We define the four intervals
  (I<sub>1,1</sub>(RD<sub>i</sub>),
  I<sub>1,2</sub>(RD<sub>i</sub>),
  I<sub>2,1</sub>(RD<sub>i</sub>),
  I<sub>2,2</sub>(RD<sub>i</sub>))
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (7) </td> 
        <td nowrap valign="top" rowspan="2"> (AZ1P(RD<sub>i</sub>)-AZ1W(RD<sub>i</sub>)/2) mod 360 > (AZ1P(RD<sub>i</sub>)+AZ1W(RD<sub>i</sub>)/2) mod 360  &#8658;<sup>&nbsp;</sup></td> 
        <td valign="top"> I<sub>1,1</sub>(RD<sub>i</sub>) = [0,(AZ1P(RD<sub>i</sub>)+AZ1W(RD<sub>i</sub>)/2) mod 360]<sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap>, where </td> 
      </tr>
      <tr>
        <td valign="top"> &#8743; I<sub>1,2</sub>(RD<sub>i</sub>) = [(AZ1P(RD<sub>i</sub>)-AZ1W(RD<sub>i</sub>)/2) mod 360, 360] <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top" rowspan="1"> (AZ1P(RD<sub>i</sub>)-AZ1W(RD<sub>i</sub>)/2) mod 360 < (AZ1P(RD<sub>i</sub>)+AZ1W(RD<sub>i</sub>)/2) mod 360 &#8658; <sup>&nbsp;</sup></td> 
        <td valign="top"> I<sub>1,1</sub>(RD<sub>i</sub>) = I<sub>1,2</sub>(RD<sub>i</sub>) = [(AZ1P(RD<sub>i</sub>)-AZ1W(RD<sub>i</sub>)/2) mod 360, (AZ1P(RD<sub>i</sub>)-AZ1W(RD<sub>i</sub>)/2) mod 360] <sup>&nbsp;</sup></td>
        </tr>
      </table>
   </center>
</p>

<p class="par">
  mod is the real-valued modulo operator.  The same for the second
  central angle.
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="3"> (8) </td> 
         <td nowrap valign="top" rowspan="2"> (AZ2P(RD<sub>i</sub>)-AZ2W(RD<sub>i</sub>)/2) mod 360 > (AZ2P(RD<sub>i</sub>)+AZ2W(RD<sub>i</sub>)/2) mod 360  &#8658;<sup>&nbsp;</sup></td> 
         <td valign="top"> I<sub>2,1</sub>(RD<sub>i</sub>) = [0,(AZ2P(RD<sub>i</sub>)+AZ2W(RD<sub>i</sub>)/2) mod 360]<sup>&nbsp;</sup></td>
         <td align="left" rowspan="3" nowrap>. </td> 
       </tr>
       <tr>
         <td valign="top"> &#8743; I<sub>2,2</sub>(RD<sub>i</sub>) = [(AZ2P(RD<sub>i</sub>)-AZ2W(RD<sub>i</sub>)/2) mod 360, 360] <sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top" rowspan="1"> (AZ2P(RD<sub>i</sub>)-AZ2W(RD<sub>i</sub>)/2) mod 360 < (AZ2P(RD<sub>i</sub>)+AZ2W(RD<sub>i</sub>)/2) mod 360 &#8658; <sup>&nbsp;</sup></td> 
         <td valign="top"> I<sub>2,1</sub>(RD<sub>i</sub>) = I<sub>2,2</sub>(RD<sub>i</sub>) = [(AZ2P(RD<sub>i</sub>)-AZ2W(RD<sub>i</sub>)/2) mod 360, (AZ2P(RD<sub>i</sub>)-AZ2W(RD<sub>i</sub>)/2) mod 360] <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  Our selection function is then:
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="2"> (9) </td> 
         <td nowrap rowspan="2"> <i>h</i>(RD<sub>i</sub>)(<i>x</i>) = <sup>&nbsp;</sup></td> 
         <td valign="top"> 1 <sup>&nbsp;</sup></td>
         <td valign="top"> if <sup>&nbsp;</sup></td>
         <td valign="top"> (<i>x</i> &#8712; I<sub>1,1</sub>(RD<sub>i</sub>) &#8744; <i>x</i> &#8712; I<sub>1,2</sub>(RD<sub>i</sub>) &#8744; <i>x</i> &#8712; I<sub>2,1</sub>(RD<sub>i</sub>) &#8744; <i>x</i> &#8712; I<sub>2,2</sub>(RD<sub>i</sub>)) <sup>&nbsp;</sup></td>
         <td align="left" rowspan="2" nowrap>. </td> 
       </tr>
       <tr>
         <td valign="top"> 0 <sup>&nbsp;</sup></td>
         <td valign="top"> &nbsp; </td>
         <td valign="top"> otherwise <sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>


<p class="par">
  The (face-on) surface brightness
  <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) of one (sub-) ring in
  one disk is a selection of (up to) two wedges in azimuth of the sum
  of harmonic terms up to 4th order in azimuth and up to four Gaussian
  distortions
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="6"> (10) </td> 
         <td nowrap valign="top"> <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>)  <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>h</i>(RD<sub>i</sub>)(180&deg;&middot;<i>&phi;</i>/&pi;) &#183; (<i>B</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) + <i>B</i><sub>2</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>))<sup>&nbsp;</sup></td>
         <td align="left" rowspan="6" nowrap>, and</td> 
       </tr>
    </table>
  </center>
</p>

<p class="par">
  is hence for one (sub-) ring at radius RD<sub>i</sub> a 21-parameter function in azimuth
  <i>&#966;</i>. Notice that because of the definitions (8) and (9), <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) is 0 if <i>R</i> lies outside the sub-ring interval [RD<sub>i</sub>-RADSEP/2, RD<sub>i</sub>+RADSEP/2). The cartesian coordinates <i>x</i>, <i>y</i>, <i>z</i> transform into the cylindric coordinates <i>R</i>, <i>&#966;</i> via eq. (1).

<!--Again, as described in the chapter <a
  href="modelling_strategy.html">Modelling Strategy</a>, the
  parameters for a sub-ring of one disk and hence at the radius
  RD<sub>i</sub> are a result of a linear interpolation of the
  parameters for this disk specified by the user at some user-defined
  radial nodes.  As an initial step, a sufficient number of point
  sources (with a user-specified total flux defined for each disk) is
  distributed over each sub-ring to represent the surface-brightness
  structure described above. Within this process, the radii of the
  point sources are continuous (but correctly distributed weighting by
  radius), but the radii of the parameters are not, i.e., there is
  only one parameter value per parameter per sub-ring. 
-->
</p>



<a name="Vertical density distribution"><h4>Vertical density distribution</h4></a>

<p class="par">
  To transfer the face-on surface brightness distribution
  <i>B</i>(RD<sub>i</sub>)(<i>&#966;</i>, <i>R</i>) into a 3D luminosity density
  <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>,<i>&#966;</i>,  <i>Z</i>), the
  assumption is made that <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>, <i>Z</i>) is separable into a
  surface brightness <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&phi;</i>) and a
  (one-parametric) scale profile <i>H</i>(RD<sub>i</sub>)(<i>Z</i>)
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="Scale profile">
       <tr>
         <td align="left" rowspan="2"> (11) </td> 
         <td nowrap valign="top"> <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>, <i>Z</i>)  <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>B</i>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>) &#183; <i>H</i>(RD<sub>i</sub>)(<i>Z</i>)<sup>&nbsp;</sup></td>
         <td align="left" rowspan="2" nowrap>.</td> 
       </tr>
    </table>
  </center>
</p>

<p class="par">
  <i>H</i>(RD<sub>i</sub>)(<i>Z</i>) = <i>H</i>(Z0(RD<sub>i</sub>))(<i>Z</i>) is parametrised by a scale height
  Z0(RD<sub>i</sub>) (in arcsec) and a pre-defined functional form. The user
  has the choice between:
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td nowrap valign="middle" rowspan="5">(12) &nbsp;&nbsp;&nbsp; <i>H</i>(Z0(RD<sub>i</sub>))(<i>Z</i>) = </td> 
         <td valign="top">0) &nbsp;&nbsp;&nbsp; (2&#183;Z0(RD<sub>i</sub>))<sup>-1</sup> for -Z0(RD<sub>i</sub>)&nbsp;<&nbsp;<i>Z</i>&nbsp;<&nbsp;Z0(RD<sub>i</sub>), 0 otherwise <sup>&nbsp;</sup></td>
<td valign="top"> Constant layer with thickness Z0(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
         <td align="left" rowspan="5" nowrap>. </td> 
       </tr>
       <tr>
         <td valign="top">1) &nbsp;&nbsp;&nbsp;   ((2&#183;&#960;)<sup>1/2</sup>&#183;Z0(RD<sub>i</sub>))<sup>-1</sup>&#183;<i>exp</i>(<i>Z</i><sup>2</sup>&#183;(2&#183;Z0<sup>2</sup>(RD<sub>i</sub>))<sup>-1</sup>) <sup>&nbsp;</sup></td>
<td valign="top">    Gaussian with standard deviation Z0(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td valign="top">2) &nbsp;&nbsp;&nbsp; (2&#183;Z0(RD<sub>i</sub>))<sup>-1</sup>&#183;<i>sech</i>^2(<i>Z</i>&#183;Z0<sup>-1</sup>(RD<sub>i</sub>)) </td>
<td valign="top">    Secans Hyperbolicus squared with thickness Z0(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td valign="top">3) &nbsp;&nbsp;&nbsp; (2&#183;Z0(RD<sub>i</sub>))<sup>-1</sup>&#183;exp(-|<i>Z</i>&#183;Z0<sup>-1</sup>(RD<sub>i</sub>)|) <sup>&nbsp;</sup></td>
<td valign="top">  Exponential layer with thickness Z0(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td valign="top">4) &nbsp;&nbsp;&nbsp; Z0(RD<sub>i</sub>)&#183;(&#960;&#183;(<i>Z</i><sup>2</sup>+Z0<sup>2</sup>(RD<sub>i</sub>))) <sup>&nbsp;</sup></td>
<td valign="top">  Lorentzian layer with thickness Z0(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  Each point source is hence assigned a random-generated height <i>Z</i> above
  the central plane with a random distribution conforming to above equations (13), and parametrised
  by the scale height Z0(RD<sub>i</sub>). The cartesian coordinates <i>x</i>, <i>y</i>, <i>z</i> transform into the cylindric coordinates <i>R</i>, <i>&#966;</i>, and <i>Z</i> via eq. (1). Again,
  Z0(RD<sub>i</sub>) is defined per sub-ring, while the user
  determines Z0(RADI<sub>j</sub>) at radial nodes. Z0(RD<sub>i</sub>) is
  calculated via linear interpolation between the nodes.
</p>



<a name="Velocity structure I"><h4>Velocity structure I</h4></a>

<p class="par">
  The velocity structure is parametrised via the
  parameters rotation velocity VROT(RD<sub>i</sub>) (in km
  s<sup>-1</sup>), harmonic terms in tangential (rotation) velocity ROkA(RD<sub>i</sub>) (amplitude kth order, k = 1, ..., 4) and ROkP(RD<sub>i</sub>) (amplitude kth order, k = 1, ..., 4),  vertical gradient of the rotation velocity
  DVRO(RD<sub>i</sub>) (in km
  s<sup>-1</sup> arcsec<sup>-1</sup>),
  radial velocity VRAD(RD<sub>i</sub>) (in km s<sup>-1</sup>), harmonic terms in radial velocity RAkA(RD<sub>i</sub>) (amplitude kth order, k = 1, ..., 4) and RAkP(RD<sub>i</sub>) (amplitude kth order, k = 1, ..., 4),
  vertical gradient in radial velocity DVRA(RD<sub>i</sub>) (in
  km s<sup>-1</sup> arcsec<sup>-1</sup>), the vertical velocity
  VVER(RD<sub>i</sub>) (in km s<sup>-1</sup>), and the vertical
  gradient in the vertical velocity DVVE(RD<sub>i</sub>) (in
  km s<sup>-1</sup> arcsec<sup>-1</sup>) (no harmonics of the vertical component is implemented at this moment), as well a the onset heights above the plane ZDRO(RD<sub>i</sub>) (in
  arcsec) for the rotation (tangential) velocity, ZDRA(RD<sub>i</sub>) (in
  arcsec) for the radial velocity, and ZDVE(RD<sub>i</sub>) (in
  arcsec) for the vertical velocity. With those the velocity
  distribution in dependence of position is calculated via
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="6"> (13)&nbsp;&nbsp;&nbsp; </td> 
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>R</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > VRAD(RD<sub>i</sub>)+&Sigma;<sub>k = 1,...,4</sub> RAkA(RD<sub>i</sub>)&middot;<i>cos</i>(k&middot;(<i>&phi;</i>-&pi;&middot;RAkP(RD<sub>i</sub>)/180&deg;))<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| &le; |ZDRA(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
         <td align="left" rowspan="6" nowrap> &nbsp;&nbsp;&nbsp;</td> 
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>R</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > VRAD(RD<sub>i</sub>)+&Sigma;<sub>k = 1,...,4</sub> RAkA(RD<sub>i</sub>)&middot;<i>cos</i>(k&middot;(<i>&phi;</i>-&pi;&middot;RAkP(RD<sub>i</sub>)/180&deg;))+DVRA(RD<sub>i</sub>)&#183;(|<i>Z</i>|-|ZDRA(RD<sub>i</sub>)|)<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| > |ZDRA(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>&#966;</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > VROT(RD<sub>i</sub>)+&Sigma;<sub>k = 1,...,4</sub> ROkA(RD<sub>i</sub>)&middot;<i>cos</i>(k&middot;(<i>&phi;</i>-&pi;&middot;ROkP(RD<sub>i</sub>)/180&deg;))<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| &le; |ZDRO(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>&#966;</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > VROT(RD<sub>i</sub>)+&Sigma;<sub>k = 1,...,4</sub> ROkA(RD<sub>i</sub>)&middot;<i>cos</i>(k&middot;(<i>&phi;</i>-&pi;&middot;ROkP(RD<sub>i</sub>)/180&deg;))+DVRO(RD<sub>i</sub>)&#183;(|<i>Z</i>|-|ZDRO(RD<sub>i</sub>)|)<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| > |ZDRO(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>Z</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>sign</i>(<i>Z</i>)&#183;(VVER(RD<sub>i</sub>)<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| &le; |ZDVE(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>Z</sub>(RD<sub>i</sub>)(<i>Z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>sign</i>(<i>Z</i>)&#183;(VVER(RD<sub>i</sub>)+DVVE(RD<sub>i</sub>)&#183;(|<i>Z</i>|-|ZDVE(RD<sub>i</sub>)|)<sup>&nbsp;</sup></td>
         <td valign="top" > if |<i>Z</i>| > |ZDVE(RD<sub>i</sub>)|<sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>

<p class="par">
  in local coordinates and via (see eq. 1)
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr> 
         <td align="left" rowspan="3"> (14) &nbsp;&nbsp;&nbsp;</td> 
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>x</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sup>p</sup><sub>R</sub>(RD<sub>i</sub>)(<i>Z</i> = <i>z</i>)&#183;<i>cos</i>(<i>&#966;(<i>x</i>, <i>y</i>)</i>)-<i>V</i><sup>p</sup><sub>&#966;</sub>(RD<sub>i</sub>)(<i>Z</i> = <i>z</i>)&#183;<i>sin</i>(<i>&#966;(<i>x</i>, <i>y</i>)</i>)<sup>&nbsp;</sup></td>
         <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;in Cartesian coordinates,</td> 
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>y</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sup>p</sup><sub>R</sub>(RD<sub>i</sub>)(<i>Z</i> = <i>z</i>)&#183;<i>sin</i>(<i>&#966;</i>(<i>x</i>, <i>y</i>))+<i>V</i><sup>p</sup><sub>&#966;</sub>(RD<sub>i</sub>)(<i>Z</i> = <i>z</i>)&#183;<i>cos</i>(<i>&#966;</i>(<i>x</i>, <i>y</i>))<sup>&nbsp;</sup></td>
       </tr>
       <tr>
         <td nowrap valign="top"> <i>V</i><sup>p</sup><sub>z</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top"> <i>V</i><sup>p</sup><sub>Z</sub>(RD<sub>i</sub>)(<i>Z</i> = <i>z</i>)<sup>&nbsp;</sup></td>
       </tr>
    </table>
  </center>
</p>
<p class="par">
  in Cartesian coordinates, hence transforming the luminosity density
  <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) = <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>(<i>x</i>, <i>y</i>, <i>z</i>), <i>&#966;</i>(<i>x</i>, <i>y</i>, <i>z</i>), <i>Z</i>(<i>x</i>, <i>y</i>, <i>z</i>)) into a
  phase-space luminosity density <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>,
  <i>V</i><sub>z</sub>) = <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>, <i>Z</i>, <i>V</i><sub>R</sub>, <i>V</i><sub>&#966;</sub>,
  <i>V</i><sub>Z</sub>):
</p>
<!--
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="3"> (x)&nbsp;&nbsp;&nbsp; </td> 
         <td nowrap valign="top"> <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>(<i>x</i>, <i>y</i>, <i>z</i>), <i>&phi;</i>(<i>x</i>, <i>y</i>, <i>z</i>), <i>Z</i>(<i>x</i>, <i>y</i>, <i>z</i>), <i>V</i><sub>R</sub>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>), <i>V</i><sub>&phi;</sub>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>), <i>V</i><sub>Z</sub>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>)) <sup>&nbsp;</sup></td>
         <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, with</td> 
       </tr>
       <tr>
         <td nowrap valign="top"> <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>R</i>, <i>&#966;</i>, <i>Z</i>)&#183;&#948;(<i>V</i><sub>R</sub>-<i>V</i><sup>p</sup><sub>R</sub>(RD<sub>i</sub>)(<i>Z</i>))&#183;&#948;(<i>V</i><sub>&#966;</sub>-<i>V</i><sup>p</sup><sub>&#966;</sub>(RD<sub>i</sub>)(<i>Z</i>))&#183;&#948;(<i>V</i><sub>Z</sub>-<i>V</i><sup>p</sup><sub>Z</sub>(RD<sub>i</sub>)(<i>Z</i>))<sup>&nbsp;</sup></td>

       </tr>
    </table>
  </center>
</p>
-->
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
       <tr>
         <td align="left" rowspan="3"> (15)&nbsp;&nbsp;&nbsp; </td> 
         <td nowrap valign="top"> <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td> 
         <td valign="top" > = <sup>&nbsp;</sup></td> 
         <td valign="top" > <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>)&#183;&#948;(<i>V</i><sub>x</sub>-<i>V</i><sup>p</sup><sub>x</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>))&#183;&#948;(<i>V</i><sub>&#966;</sub>-<i>V</i><sup>p</sup><sub>y</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>), <i>z</i>))&#183;&#948;(<i>V</i><sub>z</sub>-<i>V</i><sup>p</sup><sub>z</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>))<sup>&nbsp;</sup></td>

       </tr>
    </table>
  </center>
</p>

<p class="par">
  &#948; denoting the Dirac delta function. At this stage the
  theoretical phase-space luminosity density is hence razor-thin in
  the velocity domain. Computationally, above equations only mean that
  each generated point source is assigned a velocity following
  equation (14) or (15). A positive rotation velocity
  VROT(RD<sub>i</sub>) hence corresponds to a counterclockwise
  rotation, a positive vertical gradient DVRO(RD<sub>i</sub>) in
  rotation velocity implies an increasing rotation velocity with
  increasing distance from the mid-plane |<i>Z</i>|. A positive radial
  velocity VRAD(RD<sub>i</sub>) corresponds to an outwards
  motion, and a positive vertical gradient in radial velocity
  DVRA(RD<sub>i</sub>) implies an increasing radial velocity
  with increasing distance from the mid-plane |<i>Z</i>|. A positive
  vertical velocity VVER(RD<sub>i</sub>) corresponds to a
  vertical motion away from the mid-plane, and a positive vertical
  gradient in vertical velocity DVVE(RD<sub>i</sub>) implies an
  increasing vertical velocity with increasing distance from the
  mid-plane |<i>Z</i>|.  Since for each generated point source the
  position is known, its (3D) velocity can be calculated by applying
  above equations (and this is actually done in TiRiFiC), generating a
  6D phase space cloud of point sources.
</p>
<p class="par">
Notice that the simplified model for bar streaming using the 3-parametric prescription of <a href="http://adsabs.harvard.edu/abs/2007ApJ...664..204S">Spekkens & Sellwood (2007)</a> (eq. 5 therein), as realised in the <a href="http://www.physics.rutgers.edu/~spekkens/diskfit/">diskfit</a> velocity field (and total-intensity) analysis software can be realised as a special case using above harmonic terms of second order. Choosing RO2A(RD<sub>i</sub>), RA2A(RD<sub>i</sub>), and (e.g.) RO2P(RD<sub>i</sub>) as free parameters, while RA2P(RD<sub>i</sub>) is kept tied to RO2P(RD<sub>i</sub>) via RA2P(RD<sub>i</sub>) = RO2P(RD<sub>i</sub>) + 45&deg; (choose RA2P and RO2P to be in the same <a href="model_fitting.html#General fitting concept">parameter group</a> when fitting), the bar angle &theta;<sub>b</sub> in eq. 5 of <a href="http://adsabs.harvard.edu/abs/2007ApJ...664..204S">Spekkens & Sellwood (2007)</a> becomes RO2P(RD<sub>i</sub>) + 90&deg;, <i>V</i><sub>2, t</sub> = RO2A(RD<sub>i</sub>), <i>V</i><sub>2, r</sub> = RA2A(RD<sub>i</sub>).
</p>



<a name="Vertical harmonic distortions"><h4>Vertical harmonic distortions</h4></a>


<p class="par">
  Galactic disks commonly show a bending, known as "warping". One of
  the purposes of the tilted-ring model was originally to cope with
  the fact that the orientation of the orbits might change with the
  radius. With this approch, it was possible to model symmetrically
  warped galaxies. To also be able to account for a more complex
  vertical structure, a higher degree of complexity can be
  added. After the velocity structure is imposed to the model,
  the user has the possibility to add harmonic vertical excursions of
  the disk up to the 4th order. Accordingly, the spatial geometry of
  the model is corrected by introducing vertical harmonic distortions.
</p>


<p class="par">
  For each sub-ring, the luminosity density
  <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) is changed
  employing five amplitudes WM0A(RD<sub>i</sub>),
  WM1A(RD<sub>i</sub>), WM2A(RD<sub>i</sub>),
  WM3A(RD<sub>i</sub>), WM4A(RD<sub>i</sub>) (with units
  of arcsec), and four azimuthal offsets (phases in units of degrees)
  WM1P(RD<sub>i</sub>), WM2P(RD<sub>i</sub>),
  WM3P(RD<sub>i</sub>), WM4P(RD<sub>i</sub>) to induce
  vertical harmonic distortions to the model. <i>J</i><sub>1</sub>(RD<sub>i</sub>) gets
  transformed into <i>J</i><sub>2</sub>(RD<sub>i</sub>) and accordingly
  <i>j</i><sub>1</sub>(RD<sub>i</sub>) gets transformed into <i>j</i><sub>2</sub>(RD<sub>i</sub>)
  following the equations:
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (16)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>J</i><sub>2</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>J</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i> - WM0A(RD<sub>i</sub>)-&#931;<sub>k = 1,...,4</sub> WMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&#183;(<i>&#966;</i>(<i>x</i>, <i>y</i>)-&pi;&middot;WMkP(RD<sub>i</sub>)/180&#176;))<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (17)&nbsp;&nbsp;&nbsp; </td> 
<td nowrap valign="top"> <i>j</i><sub>2</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>j</i><sub>1</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i> - WM0A(RD<sub>i</sub>)-&#931;<sub>k = 1,...,4</sub> WMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&#183(<i>&#966;</i>(<i>x</i>, <i>y</i>)-&pi;&middot;WMkP(RD<sub>i</sub>)/180&#176;)), <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup></td>
        <td align="left" rowspan="2"> &nbsp;&nbsp;&nbsp;, </td> 
      </tr>
   </table>
  </center>
</p>

<p class="par">
with the coordinate transformations specified in eq. (1). Computationally, the height above the plane <i>z</i> (the same as the cylindric coordinate <i>Z</i>) of each point
source gets transformed to <i>z</i>' via
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (18)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>z</i>&#8242; <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>z</i> +  WM0A(RD<sub>i</sub>)+&#931;<sub>k = 1,...,4</sub> WMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&#183;(<i>&#966;</i>(<i>x</i>, <i>y</i>)-&pi;&middot;WMkP(RD<sub>i</sub>)/180&#176;))<sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
    </table>
  </center>
</p>

<a name="Tilting to inclination"><h4>Tilting to inclination</h4></a>

<p class="par">
  Applying a rotation about the first axis (x, axis pointing to the North) with a
  rotation angle INCL(RD<sub>i</sub>), the cloud of point
  sources becomes tilted in the next step. Let
  A<sub>incl</sub>(INCL(RD<sub>i</sub>)) be the linear
  transformation defined by
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (19)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  A<sup>x</sup><sub>incl</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x<sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, where</td> 
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>y</sup><sub>incl</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> y&#183;<i>cos</i>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)-z&#183;<i>sin</i>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)<sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>z</sup><sub>incl</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> y&#183;<i>sin</i>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)+z&#183;<i>cos</i>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>

<p class="par">
  the inclination INCL(RD<sub>i</sub>) is measured in degrees
  and the trigonometric functions are defined having radians as an
  argument. A<sub>incl</sub>(INCL(RD<sub>i</sub>)) corresponds
  to a (right-handed, anti-clockwise) rotation by
  INCL(RD<sub>i</sub>) axout the x-axis. Then, the phase-space
  luminosity density <i>j</i><sub>2</sub>(RD<sub>i</sub>) transforms to
  <i>j</i><sub>3</sub>(RD<sub>i</sub>) via
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (20) </td> 
        <td valign="top"> <i>j</i><sub>3</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>j</i><sub>2</sub>(RD<sub>i</sub>)(
        A<sup>-1</sup><sub>incl</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>), 
        A<sup>-1</sup><sub>incl</sub>(RD<sub>i</sub>)(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup>
        </td>
        <td align="left" rowspan="2" nowrap> &nbsp;&nbsp;&nbsp;, where</td> 
      </tr>
    </table>
  </center>
</p>

<p class="par">
  A<sup>-1</sup><sub>incl</sub>(RD<sub>i</sub>) =
  A<sup>-1</sup><sub>incl</sub>(INCL(RD<sub>i</sub>)) is the
  inverse transformation of
  A<sup></sup><sub>incl</sub>(RD<sub>i</sub>). Computationally,
  this corresponds to a rotation of each point source with the
  Cartesian coordinates (<i>x</i>, <i>y</i>, <i>z</i>,
  <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>)
  about the x-axis to the coordinates (<i>x</i>&#8242;,
  <i>y</i>&#8242;, <i>z</i>&#8242;, <i>V</i>&#8242;<sub>x</sub>,
  <i>V</i>&#8242;<sub>y</sub>, <i>V</i>&#8242;<sub>z</sub>), according
  to equation (15)
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="6"> (21)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top"> <i>x</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="6" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top"> <i>y</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>z</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>x</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>y</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>z</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>

<a name="Shifts along principal axes"><h4>Shifts along principal axes</h4></a>

<p class="par">
  The symmetry centre can be shifted with changing the central
  coordinates of the model with radius (see below). It can, however,
  be instructive to directly apply a shift along the principal axes of
  the projected orbits (major and minor axes of the projected ellipse
  describing a projected circular orbit). A shift along the major axis
  could e.g. never correspond to a bowl-shaped warp, but indicates a
  lopsidedness of the orbital structure. Hence, TiRiFiC gives the user
  the possibility to apply a shift along the principal axes.
</p>


<p class="par">
  A shift along the projected minor axis is induced by specifying the
  parameter LC0, a shift along the minor axis is achieved with a
  non-vanishing parameter LS0. The phase-space luminosity density
  <i>j</i><sub>3</sub>(RD<sub>i</sub>) transforms to <i>j</i><sub>4</sub>(RD<sub>i</sub>), following
  the equations
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (22) </td> 
        <td valign="top"> <i>j</i><sub>4</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td> <i>j</i><sub>3</sub>(RD<sub>i</sub>)(<i>x</i>-LC0(RD<sub>i</sub>), <i>y</i>-LS0(RD<sub>i</sub>), <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="1" nowrap> &nbsp;&nbsp;&nbsp;, which</td> 
      </tr>
   </table>
</center>
</p>

<p class="par">
  corresponds to a shift of each point source with the Cartesian
  coordinates (<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>,
  <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) along the x-axis and the
  y-axis to result in the revised coordinates (<i>x</i>&#8242;,
  <i>y</i>&#8242;, <i>z</i>&#8242;, <i>V</i>&#8242;<sub>x</sub>,
  <i>V</i>&#8242;<sub>y</sub>, <i>V</i>&#8242;<sub>z</sub>) with
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="6"> (23)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top"> <i>x</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>x</i>+LC0(RD<sub>i</sub>) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="6" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top"> <i>y</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>y</i>+LS0(RD<sub>i</sub>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>z</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>z</i> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>x</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>x</sub> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>y</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>y</sub> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>z</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>z</sub> <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>



<a name="Velocity structure II (post-rotation)"><h4>Velocity structure II (post-rotation)</h4></a>

<p class="par">
  The usage of harmonic expansions of the recession velocity along the
  line-of-sight (<i>z</i>) to characterise the second-order kinematics
  is a technique that has been applied to velocity fields in the past
  <a href="http://irs.ub.rug.nl/ppn/183679792">(Schoenmakers 1999)</a>
  and can hence not be missing in TiRiFiC.
</p>
<p class="par">
  At this stage, no geometrical contributions to the velocity in x-
  and y- component will alter the final artificially observed
  intensity any more. Firstly, no geometrical transformation (like a
  tilt) is done any more that would make these changes visible,
  secondly, as mentioned in the chapter <a
  href="modelling_strategy.html">Modelling Strategy</a>, tbe
  simplifying assumption that a parallel projection is sufficient to
  grid the Intensity to a data cube. Hence, when looking at variations
  in velocity, only the z-component alone is relevant. Hence, the
  <i>z</i>-component of the velocity alone is expanded into a Fourier
  series up to the fourth order. This is controlled by supplying 5
  amplitudes VM0A(RD<sub>i</sub>), VM1A(RD<sub>i</sub>),
  VM2A(RD<sub>i</sub>), VM3A(RD<sub>i</sub>),
  VM4A(RD<sub>i</sub>) (given in units of
  km&nbsp;s<sup>-1</sup>), and four azimuthal offsets (phases in units
  of degrees) VM1P(RD<sub>i</sub>), VM2P(RD<sub>i</sub>),
  VM3P(RD<sub>i</sub>), VM4P(RD<sub>i</sub>) to induce
  harmonic distortions in velocity along the line-of-sight to the
  model. <i>j</i><sub>4</sub>(RD<sub>i</sub>) gets transformed into
  <i>j</i><sub>5</sub>(RD<sub>i</sub>) following the equation
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (24) </td> 
        <td valign="top"> <i>j</i><sub>5</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>j</i><sub>4</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>- VM0A(RD<sub>i</sub>)-&#931;<sub>k = 1,...,4</sub> VMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&middot;(<i>&phi;</i>&prime;(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>)-&pi;&middot;VMkP(RD<sub>i</sub>)/180&#176;)) <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="2" nowrap>, with</td> 
      </tr>
   </table>
</center>
</p>

<p class="par">
  <i>&phi;</i>&prime;(RD<sub>i</sub>) denoting the azimuthal angle computed via eq. (1) before tilting to inclination and shifting along principal axes
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (25) </td> 
        <td valign="top"> <i>&phi;</i>&prime;(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>&phi;</i>(A<sup>-1</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(<i>x</i>-LC0(RD<sub>i</sub>), <i>y</i>-LS0(RD<sub>i</sub>), z)) <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="2" nowrap>, with</td> 
      </tr>
   </table>
</center>
</p>
<p class="par">
<i>&phi;</i>(<i>x</i>, <i>y</i>, <i>z</i>) being defined in eq. (1). Computationally, the <i>V</i><sub>z</sub> component of each point
  source gets transformed to <i>V</i>&#8242;<sub>z</sub> via
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (26)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>V</i>&#8242;<sub>z</sub> <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>z</sub> +  VM0A(RD<sub>i</sub>)+&#931;<sub>k = 1,...,4</sub> VMkA(RD<sub>i</sub>)&#183;<i>cos</i>(k&middot;(<i>&phi;</i>&prime;(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>)-&pi;&middot;VMkP(RD<sub>i</sub>)/180&#176;))<sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
    </table>
  </center>
</p>

<p class="par">
  TiRiFiC offers a multitude of alternative parametrisation methods of
  the same observation. E.g., putting aside a constant correction
  factor, the same data cube can be simulated by varying the rotation
  amplitude VROT or the first order harmonics in Velocity VM1A with a
  choice VM1P = 0&#176;. An inwards motion (VRAD) is equivalent to
  adding a first order harmonics in velocity VM1A with a phase (or
  azimuthal offset) of 90&#176;. There are, however, preferences for
  the choice of the precise parametrisation technique, and we like to
  serve all tastes. It should also be pointed out that the sign of the
  harmonic distortions in velocity is the opposite of the sign of the
  recession velocity. A higher velocity in the TiRiFiC reference
  system (in which we are currently discussing the parametrisation)
  corresponds to a lower recession velocity, since the z-axis is
  pointing towards the observer.
</p>
<a name="Rotating to position angle"><h4>Rotating to position angle</h4></a>

<p class="par">
  Next, the rotation about the third axis
  (line-of-sight) by the position angle PA(RD<sub>i</sub>) is
  applied. The transformation is an analogue to the application of a
  tilt via the inclination, apart from the fact that the rotation axis
  is the third axis (<i>z</i>) and the addition of 180&#176; to the
  position angle specified by the user before making use of it as a
  parameter for the rotation. The reason for doing so is mainly
  historical. To conform with the position angle definition of <a
  href="http://www.astro.rug.nl/~gipsy/">GIPSY</a>, which in the
  relevant tasks (e.g. <a
  href="http://www.astro.rug.nl/~gipsy/tsk/rotcur.dc1">rotcur</a>, <a
  href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>)
  defines the position angle as the angle included by the lines from
  the origin to the North and the <i>receding</i> side half major axis
  of the projected orbit, a shift by 180&#176; becomes necessary (many
  users want to compare the results of TiRiFiC with results from <a
  href="http://www.astro.rug.nl/~gipsy/">GIPSY</a> tasks, such that a
  difference by 180&#176; in the position angle between TiRiFiC and <a
  href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>
  would be quite inconvenient).  Let
  A<sub>pa</sub>(PA(RD<sub>i</sub>)) be the linear
  transformation defined by
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (27)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  A<sup>x</sup><sub>pa</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>cos</i>(&#960;&#183;(PA(RD<sub>i</sub>)+180&#176;)/180&#176;)-y&#183;<i>sin</i>(&#960;&#183;(PA(RD<sub>i</sub>)+180&#176;)/180&#176;)<sup>&nbsp;</sup>        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, where</td> 
</td>
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>y</sup><sub>pa</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>sin</i>(&#960;&#183;(PA(RD<sub>i</sub>)+180&#176;)/180&#176;)+y&#183;<i>cos</i>(&#960;&#183;(PA(RD<sub>i</sub>)+180&#176;)/180&#176;)<sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>z</sup><sub>pa</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> z<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>

<p class="par">
  the position angle PA(RD<sub>i</sub>) is measured in degrees
  and the trigonometric functions are defined as having radians as an
  argument. A<sub>pa</sub>(PA(RD<sub>i</sub>)) corresponds
  to a (right-handed, anti-clockwise) rotation by
  PA(RD<sub>i</sub>)+180&#176; axout the x-axis. Then, the phase-space
  luminosity density <i>j</i><sub>5</sub>(RD<sub>i</sub>) transforms to
  <i>j</i><sub>6</sub>(RD<sub>i</sub>) via
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (28) </td> 
        <td valign="top"> <i>j</i><sub>6</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top">  <i>j</i><sub>5</sub>(RD<sub>i</sub>)(
        A<sup>-1</sup><sub>pa</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>), 
        A<sup>-1</sup><sub>pa</sub>(RD<sub>i</sub>)(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))                   <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="2" nowrap> &nbsp;&nbsp;&nbsp;, where</td> 
      </tr>
    </table>
  </center>
</p>

<p class="par">
  A<sup>-1</sup><sub>pa</sub>(RD<sub>i</sub>) =
  A<sup>-1</sup><sub>pa</sub>(PA(RD<sub>i</sub>)) is the
  inverse transformation of
  A<sup></sup><sub>pa</sub>(RD<sub>i</sub>). Computationally,
  this corresponds to a rotation of each point source with the
  Cartesian coordinates (<i>x</i>, <i>y</i>, <i>z</i>,
  <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>)
  about the z-axis to the coordinates (<i>x</i>&#8242;,
  <i>y</i>&#8242;, <i>z</i>&#8242;, <i>V</i>&#8242;<sub>x</sub>,
  <i>V</i>&#8242;<sub>y</sub>, <i>V</i>&#8242;<sub>z</sub>), according
  to equation (27)
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="6"> (29)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top"> <i>x</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="6" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top"> <i>y</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>z</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>x</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>x</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>y</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>y</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>z</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> A<sup>z</sup><sub>pa</sub>(PA(RD<sub>i</sub>))(<i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>



<a name="Velocity dispersion"><h4>Velocity dispersion</h4></a>
<p class="par">
In the cylindric face-on reference system of a face-on disk (following the cylindric disk symmetry) there are three distinguished directions for random motion, the tangential, the radial, and the vertical direction. The TiRiFiC (future) model assumes that the velocity of the observed material has a Gaussian random component in each of these directions. We define the three diagonalising axes of the velocity ellipsoid as
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (30)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top"> <b><i>e</i></b><sub>R</sub>(<i>&#966;</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (e<sub>R</sub><sup>x</sup>(<i>&#966;</i>), e<sub>R</sub><sup>y</sup>(<i>&#966;</i>), e<sub>R</sub><sup>z</sup>(<i>&#966;</i>)) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (<i>cos</i>(<i>&#966;</i>), <i>sin</i>(<i>&#966;</i>), 0)<sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top"> <b><i>e</i></b><sub>&#981;</sub>(<i>&#966;</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (e<sub>&#981;</sub><sup>x</sup>(<i>&#966;</i>), e<sub>&#981;</sub><sup>y</sup>(<i>&#966;</i>), e<sub>&#981;</sub><sup>z</sup>(<i>&#966;</i>)) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (-<i>sin</i>(<i>&#966;</i>), <i>cos</i>(<i>&#966;</i>), 0)<sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <b><i>e</i></b><sub>Z</sub>(<i>&#966;</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (e<sub>Z</sub><sup>x</sup>(<i>&#966;</i>), e<sub>Z</sub><sup>y</sup>(<i>&#966;</i>), e<sub>Z</sub><sup>z</sup>(<i>&#966;</i>)) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (0, 0, 1)<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
With respect to the basis (<b><i>e</i></b><sub>R</sub>(<i>&#966;</i>), <b><i>e</i></b><sub>&#981;</sub>(<i>&#966;</i>), <b><i>e</i></b><sub>Z</sub>(<i>&#966;</i>)), the velocity dispersion tensor (&sigma;<sup>2</sup>) is defined to be diagonal &sigma;<sup>2</sup><sub>ij</sub> = &sigma;<sup>2</sup><sub>i</sub>&delta;<sub>ij</sub> with
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (31)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  &sigma;<sup>2</sup><sub>1</sub> <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> &sigma;<sup>2</sup><sub>R</sub> <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (a(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup> <sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top">  &sigma;<sup>2</sup><sub>2</sub> <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> &sigma;<sup>2</sup><sub>&phi;</sub> <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (b(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top">  &sigma;<sup>2</sup><sub>3</sub> <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> &sigma;<sup>2</sup><sub>Z</sub> <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (a(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup> <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
For a given rotation A, (&sigma;<sup>2</sup>) transforms with
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (32)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  (&sigma;<sup>2</sup>&#8242;)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">  A(&sigma;<sup>2</sup>)A<sup>T</sup> <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
or
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (33)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  &sigma;<sup>2</sup>&#8242;<sub>ij</sub> <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> &Sigma;<sub>kl</sub>A<sub>ik</sub>A<sub>jl</sub> &sigma;<sub>kl</sub><sup>&nbsp;</sup></td>
        <td align="left" rowspan="1" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
    </table>
  </center>
</p>
<p class="par">
Applying the rotation A<sub>&phi;</sub>
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (34)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  A<sup>x</sup><sub>&phi;</sub>(<i>&psi;</i>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>cos</i>(<i>&psi;</i>)-y&#183;<i>sin</i>(<i>&psi;</i>)<sup>&nbsp;</sup>        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, with</td> 
</td>
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>y</sup><sub>&phi;</sub>(<i>&psi;</i>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>sin</i>(<i>&psi;</i>)+y&#183;<i>cos</i>(<i>&psi;</i>)<sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>z</sup><sub>&phi;</sub>(<i>&psi;</i>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> z<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
the face-on azimuthal angle &psi; (see below), the rotation A<sub>incl</sub>(INCL(RD<sub>i</sub>)) with respect to inclination, as defined in eq. (19), the rotation A<sub>pa</sub>(PA(RD<sub>i</sub>)) with respect to position angle defined as in (27), and with <b>e</b><sub>z</sub> = (0, 0, 1) being the normal vector along the line-of-sight, we define the line-of-sight velocity spread &sigma;<sup>2</sup><sub>z</sub>(RD<sub>i</sub>)(<i>&phi;</i>) (sticking to the terminology of <a href="http://esoads.eso.org/cgi-bin/nph-data_query?bibcode=2008gady.book.....B&db_key=AST&link_type=ABSTRACT&high=4a952edbbc10597">Binney & Tremaine 2008</a>, p. 281, this is not identical to the line-of-sight velocity dispersion) by
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="10"> (35)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  &sigma;<sup>2</sup><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">   <b>e</b><sup>T</sup><sub>z</sub> A<sub>pa</sub>(PA(RD<sub>i</sub>))A<sub>incl</sub>(INCL(RD<sub>i</sub>))A<sub>&phi;</sub>(<i>&psi;</i>)(&sigma;<sup>2</sup>)A<sub>&phi;</sub>(<i>&psi;</i>)<sup>T</sup>A<sup>T</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))A<sup>T</sup><sub>pa</sub>(PA(RD<sub>i</sub>))<b>e</b><sub>z</sub> <sup>&nbsp;</sup></td>
        <td align="left" rowspan="10" nowrap>.</td> 
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <b>e</b><sup>T</sup><sub>z</sub> A<sub>incl</sub>(INCL(RD<sub>i</sub>))A<sub>&phi;</sub>(<i>&psi;</i>)(&sigma;<sup>2</sup>)A<sup>T</sup><sub>&phi;</sub>(<i>&psi;</i>)A<sup>T</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))<b>e</b><sub>z</sub> <sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <b>e</b><sup>T</sup><sub>z</sub> A<sub>incl</sub>(INCL(RD<sub>i</sub>))A<sub>&phi;</sub>(<i>&psi;</i>)(&sigma;<sup>2</sup>)A<sup>T</sup><sub>&phi;</sub>(<i>&psi;</i>)A<sup>T</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))<b>e</b><sub>z</sub> <sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> (A<sub>incl</sub>(INCL(RD<sub>i</sub>))A<sub>&phi;</sub>(<i>&psi;</i>)(&sigma;<sup>2</sup>)A<sup>T</sup><sub>&phi;</sub>(<i>&psi;</i>)A<sup>T</sup><sub>incl</sub>(INCL(RD<sub>i</sub>)))<sub>33</sub> <sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top">   &sigma;<sup>2</sup><sub>z</sub>(&sigma;<sup>2</sup><sub>R</sub>(RD<sub>i</sub>), &sigma;<sup>2</sup><sub>&phi;</sub>(RD<sub>i</sub>), &sigma;<sup>2</sup><sub>Z</sub>(RD<sub>i</sub>), INCL(RD<sub>i</sub>))(<i>&phi;</i>)<sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> &sigma;<sup>2</sup><sub>R</sub>&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>sin</i><sup>2</sup>(<i>&psi;</i>)+&sigma;<sup>2</sup><sub>&phi;</sub>&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>cos</i><sup>2</sup>(<i>&psi;</i>)+&sigma;<sup>2</sup><sub>Z</sub>&#183;<i>cos</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)<sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> (a(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup>&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>sin</i><sup>2</sup>(<i>&psi;</i>)+ (b(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup>&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>cos</i><sup>2</sup>(<i>&psi;</i>)+(c(RD<sub>i</sub>)&#183;SDIS(RD<sub>i</sub>))<sup>2</sup>&#183;<i>cos</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)<sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> SDIS<sup>2</sup>(RD<sub>i</sub>)&#183;(a<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>sin</i><sup>2</sup>(<i>&psi;</i>)+ b<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)&#183;<i>cos</i><sup>2</sup>(<i>&psi;</i>)+c<sup>2</sup>(RD<sub>i</sub>)&#183;<i>cos</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;))<sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> SDIS<sup>2</sup>(RD<sub>i</sub>)&#183;((a<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)+ b<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)+c<sup>2</sup>(RD<sub>i</sub>)&#183;<i>cos</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;))/2+(b<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;)-a<sup>2</sup>(RD<sub>i</sub>)&#183;<i>sin</i><sup>2</sup>(&#960;&#183;INCL(RD<sub>i</sub>)/180&#176;))/2&#183;<i>cos</i>(2&#183;<i>&psi;</i>))<sup>&nbsp;</sup>
        </td>
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top">   &sigma;<sup>2</sup><sub>z</sub>(SDIS(RD<sub>i</sub>),a(RD<sub>i</sub>),b(RD<sub>i</sub>),c(RD<sub>i</sub>), INCL(RD<sub>i</sub>))(<i>&psi;</i>)<sup>&nbsp;</sup>
        </td>
      </tr>
     </table>
  </center>
</p>
<p class="par">
The current implementation of TiRiFiC does not allow a variation of a(RD<sub>i</sub>), b(RD<sub>i</sub>), and c(RD<sub>i</sub>) or any linear combination (in fact, as evident from the second last line of equation (35), for a perfect disk, a best fit solution at most two of the four parameters SDIS(RD<sub>i</sub>), a(RD<sub>i</sub>), b(RD<sub>i</sub>), and c(RD<sub>i</sub>)) would be unambiguous), in other words until expressively requested (please do request this if you want to use it!), the velocity ellipsoid is a spheroid with
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (36)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  a(RD<sub>i</sub>)<sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> b(RD<sub>i</sub>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> c(RD<sub>i</sub>) <sup>&nbsp;</sup></td>
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> 1 <sup>&nbsp;</sup></td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, and hence</td> 
      </tr>
    </table>
  </center>
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="8"> (37)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  &sigma;<sup>2</sup><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">  &sigma;<sup>2</sup><sub>z</sub>(SDIS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="8" nowrap>.</td> 
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> SDIS<sup>2</sup>(RD<sub>i</sub>)<sup>&nbsp;</sup>
        </td>
      </tr>
     </table>
  </center>
</p>
<p class="par">
Only for completeness (or to make people curious), the more complex treatment is kept on this page.
</p>
<p class="par">
Defining the line-of-sight velocity distribution function
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (38)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>D</i><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>)(<i>V</i><sub>z</sub>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">  <i>D</i><sub>z</sub>(&sigma;<sup>2</sup><sub>z</sub>(SDIS(RD<sub>i</sub>), a(RD<sub>i</sub>), b(RD<sub>i</sub>), c(RD<sub>i</sub>), INCL(RD<sub>i</sub>))(<i>&psi;</i>)(<i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="2" nowrap>&nbsp;&nbsp;&nbsp;&nbsp;,</td> 
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top">(2&#960;&#183;&sigma;<sup>2</sup><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>))<sup>-1/2</sup><i>exp</i>(-<i>V</i><sup>2</sup><sub>z</sub>(2&#183;&sigma;<sup>2</sup><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>))<sup>-1</sup>)<sup>&nbsp;</sup>
        </td>
      </tr>
     </table>
  </center>
</p>
<p class="par">
with its current simplified form
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (39)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>D</i><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>)(<i>V</i><sub>z</sub>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">  <i>D</i><sub>z</sub>(&sigma;<sup>2</sup><sub>z</sub>(SDIS(RD<sub>i</sub>)))(<i>V</i><sub>z</sub>) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="1" nowrap>&nbsp;&nbsp;&nbsp;&nbsp;,</td> 
      </tr>
     </table>
  </center>
</p>
<p class="par">
the phase-space luminosity density <i>j</i><sub>6</sub>(RD<sub>i</sub>) transforms to
  <i>j</i><sub>7</sub>(RD<sub>i</sub>) via
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (40) </td> 
        <td valign="top"> <i>j</i><sub>7</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>)<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> (<i>j</i><sub>6</sub>&nbsp;<b>*</b><sub>V<sub>z</sub></sub>&nbsp;<i>D</i><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;(RD<sub>i</sub>)</i>(<i>x</i>, <i>y</i>, <i>z</i>)))(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>)  <sup>&nbsp;</sup>
        </td>        
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, with</td> 
      </tr>
      <tr>
        <td> &nbsp; <sup>&nbsp;</sup></td> 
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> &int;&nbsp;<i>j</i><sub>6</sub>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i>&#8242;<sub>z</sub>)&#183;(<i>D</i><sub>z</sub>(RD<sub>i</sub>)(<i>&psi;</i>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>)))(<i>V</i><sub>z</sub>-<i>V</i>&#8242;<sub>z</sub>)&nbsp;d<i>V</i>&#8242;<sub>z</sub> <sup>&nbsp;</sup>
        </td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
<b>*</b><sub>V<sub>z</sub></sub> denoting the one-dimensional convolution along the z-direction, and
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (41) </td> 
        <td valign="top"> <i>&psi;</i>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>) <sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>&phi;</i>(A<sup>-1</sup><sub>incl</sub>(INCL(RD<sub>i</sub>))(A<sup>-1</sup><sub>pa</sub><sup>x </sup>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>)-LC0(RD<sub>i</sub>), A<sup>-1</sup><sub>pa</sub><sup>y </sup>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>)-LS0(RD<sub>i</sub>), A<sup>-1</sup><sub>pa</sub><sup>z </sup>(PA(RD<sub>i</sub>))(<i>x</i>, <i>y</i>, <i>z</i>))) <sup>&nbsp;</sup></td> 
      </tr>
   </table>
</center>
</p>
<p class="par">
(see eq. 1) being the face-on azimuthal angle. In its current simple form, this simply reduces to a convolution per subring with a Gaussian of constant dispersion SDIS(RD<sub>i</sub>). 
</p>
<p class="par">
Computationally, this corresponds to adding a Gaussian random variate &Delta;<i>V</i><sub>z</sub> with velocity dispersion &sigma;<sub>z</sub>(SDIS(RD<sub>i</sub>), a(RD<sub>i</sub>), b(RD<sub>i</sub>), c(RD<sub>i</sub>), INCL(RD<sub>i</sub>))(<i>&psi;</i>), currently &sigma;<sub>z</sub>(SDIS(RD<sub>i</sub>)), to each point source. 
</p>
<p class="par">
TiRiFiC uses the same "sub-cloud" concept as <a
href="http://www.astro.rug.nl/~gipsy/tsk/galmod.dc1">galmod</a>. Each point source is split into CLNR nearly identical clouds, which differ in &Delta;<i>V</i><sub>z</sub> only, to reduce the quantisation noise. This way, a smoother velocity structure of the model is achieved as if a CLNR higher number of point sources was used, without having to completely re-construct them one by one.
</p>



<a name="World coordinates"><h4>World coordinates</h4></a>
<p class="par">
The user supplies the world coordinates of the centre XPOS(RD<sub>i</sub>) (right ascension in the input reference system in degrees) and YPOS(RD<sub>i</sub>) (declination in the input reference system in degrees) and the systemic velocity VSYS(RD<sub>i</sub>) (in the input reference system, in km s<sup>-1</sup>). These coordinates are transformed to the intrinsic coordinates of the central position
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (42) </td> 
        <td valign="top"> <i>x</i><sup>c</sup>(RD<sub>i</sub>) &nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td> <i>x</i><sup>c</sup>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, with</td> 
      </tr>
      <tr>
        <td valign="top"> <i>y</i><sup>c</sup>(RD<sub>i</sub>) &nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td> <i>y</i><sup>c</sup>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td> 
      </tr>
      <tr>
        <td valign="top"> <i>V</i><sup>c</sup><sub>z</sub>(RD<sub>i</sub>) &nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td> <i>V</i><sup>c</sup><sub>z</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td> 
      </tr>
    </table>
  </center>
</p>
<p class="par">
the conversion depending on the coordinate system of the input data cube. As pointed out, TiRiFiC uses a linear approximation for the projection. The central coordinates, which are transformed to intrinsic units with the aid of <a href="http://www.atnf.csiro.au/people/mcalabre/WCS/">WCSLIB</a> are the only exception. However, to the first order, the shifts in the central coordinates and the systemic velocity are proportional to the corresponding change in the intrinsic positions. In most coordinate systems which use the radio velocity as a third axis, this is even exactly true for the systemic velocity VSYS(RD<sub>i</sub>), which in the chosen intrinsic coordinate system has an opposite signum to the shift in velcocity <i>V</i><sup>c</sup><sub>z</sub>(RD<sub>i</sub>) (!).
</p>
<p class="par">
The phase-space luminosity density <i>j</i><sub>7</sub>(RD<sub>i</sub>) transforms to
  <i>j</i><sub>8</sub>(RD<sub>i</sub>) via
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (43) </td> 
        <td valign="top"> <sup>&nbsp;</sup></td>
        <td valign="top"> <sup>&nbsp;</sup></td>
        <td valign="top"> <i>j</i><sub>8</sub>(RD<sub>i</sub>)(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>))<sup>&nbsp;</sup>
        <td align="left" rowspan="2"> . </td> 
        </td>
      </tr>
      <tr>
        <td valign="top"> <sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> <i>j</i><sub>7</sub>(RD<sub>i</sub>)(<i>x</i>-<i>x</i><sup>c</sup>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)), <i>y</i>-<i>y</i><sup>c</sup>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)), <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>-<i>V</i><sup>c</sup><sub>z</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)))  <sup>&nbsp;</sup>
        </td>
      </tr>
    </table>
  </center>
</p>

<p class="par">
  This corresponds to a shift of each point source with the Cartesian
  coordinates (<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>,
  <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) along the x-axis and the
  y-axis to result to the revised coordinates (<i>x</i>&#8242;,
  <i>y</i>&#8242;, <i>z</i>&#8242;, <i>V</i>&#8242;<sub>x</sub>,
  <i>V</i>&#8242;<sub>y</sub>, <i>V</i>&#8242;<sub>z</sub>) with
</p>

<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="6"> (44)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top"> <i>x</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>x</i>+<i>x</i><sub>c</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td>
        <td align="left" rowspan="6" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top"> <i>y</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>y</i>+<i>y</i><sub>c</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>z</i>&#8242;  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>z</i> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>x</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>x</sub> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>y</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>y</sub> <sup>&nbsp;</sup></td>
      </tr>
      <tr>
        <td nowrap valign="top"> <i>V</i>&#8242;<sub>z</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> <i>V</i><sub>z</sub>+<i>V</i><sup>c</sup><sub>z</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) <sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
Please again notice that to first order <i>V</i><sup>c</sup><sub>z</sub>(XPOS(RD<sub>i</sub>), YPOS(RD<sub>i</sub>), VSYS(RD<sub>i</sub>)) = -VSYS(RD<sub>i</sub>). It should be pointed out that with the right choice of the central coordinates and the systemic velocity, a <a href="#Shifts along principal axes">shifts along principal axes</a> LC0(RD<sub>i</sub>) and LS0(RD<sub>i</sub>) become redundant, as well as the zeroth-order <a href="#Velocity structure II (post-rotation)">harmonic term in velocity</a>. Again, this is the case for several parameters and their combination. The redundancy is kept for convenience.
</p>
<a name="Projection"><h4>Projection</h4></a>
<p class="par">
In a next step, the phase-space luminosity densities <i>j</i><sub>8</sub>(RD<sub>i</sub>) are projected and all sub-rings are added up to the intensity <i>I</i><sub>1</sub> via
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (45) </td> 
        <td valign="top"> <i>I</i><sub>1</sub>(<i>x</i>, <i>y</i>, <i>V</i><sub>Z</sub>)<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> &Sigma;<sub>i = 1, ..., n</sub> &int; &int; &int;&nbsp;<i>j</i><sub>6</sub>(<i>x</i>, <i>y</i>, <i>z</i>, <i>V</i><sub>x</sub>, <i>V</i><sub>y</sub>, <i>V</i><sub>z</sub>) d<i>z</i> d<i>V</i><sub>x</sub> d<i>V</i><sub>y</sub> <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="1" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
    </table>
  </center>
</p>

<p class="par">
  This is a simplified parallel projection, which is only valid for a small field-of-view. Computationally, this corresponds to ignoring the coordinates of the point sources in <i>z</i>, <i>V</i><sub>x</sub>, and <i>V</i><sub>y</sub> direction.
</p>



<a name="Gridding"><h4>Gridding</h4></a>
<p class="par">
For computational reasons, gridding in TiRiFiC consists of a search of the nearest pixel in an array representing a data cube for each point source. The point source total flux is then added to the pixel. Mathematically, this implies a convolution with a 3D rectangle function and a multiplication with a 3D Shah function (and, in principle, a consecutive multiplication with a 3D rectangle again). Let &Delta;<sub>x</sub>, &Delta;<sub>y</sub>, and &Delta;<sub>V<sub>z</sub></sub> be the pixel sizes in x, y, and V<sub>z</sub> direction. Then the intensity <i>I</i><sub>1</sub> is transformed to <i>I</i><sub>2</sub> following
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="1"> (46) </td> 
        <td valign="top"> <i>I</i><sub>2</sub>(<i>x</i>, <i>y</i>, <i>V</i><sub>z</sub>)<sup>&nbsp;</sup></td>
        <td valign="top"> = <sup>&nbsp;</sup></td>
        <td valign="top"> &Sigma;<sub>i,j,k</sub> &#948(<i>x</i>-i&middot;&Delta;<sub>x</sub>) &#948(<i>y</i>-j&middot;&Delta;<sub>y</sub>) &#948(<i>V</i><sub>z</sub>-k&middot;&Delta;<sub>V<sub>z</sub></sub>)  (&int; &int; &int;&nbsp; <i>I</i><sub>1</sub>(<i>x</i>-<i>x</i>&prime;, <i>y</i>-<i>y</i>&prime;, <i>V</i><sub>z</sub>-<i>V</i>&prime;<sub>z</sub>) &middot; &Delta;<sup>-1</sup><sub>x</sub>&middot;&Pi;(&Delta;<sup>-1</sup><sub>x</sub>&middot;<i>x</i>&prime;)  &Delta;<sup>-1</sup><sub>y</sub>&middot;&Pi;(&Delta;<sup>-1</sup><sub>y</sub>&middot;<i>y</i>&prime;) &Delta;<sup>-1</sup><sub>x</sub>&middot;&Pi;(&Delta;<sup>-1</sup><sub>V<sub>z</sub></sub>&middot;<i>V</i>&prime;<sub>z</sub>)   d<i>x</i>&prime; d<i>y</i>&prime; d<i>V</i>&prime;<sub>z</sub>) <sup>&nbsp;</sup></td> 
        <td align="left" rowspan="1" nowrap> &nbsp;&nbsp;&nbsp;, with</td> 
      </tr>
    </table>
  </center>
</p>
        <p>
          <center>
            <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
               <tr>
                 <td align="left" rowspan="2"> (47) </td> 
                 <td nowrap valign="top">  -1/2 &le; x < 1/2 <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> &Pi;  = 1<sup>&nbsp;</sup></td>
                 <td align="left" rowspan="2" nowrap>, and</td> 
               </tr>
               <tr>
                 <td nowrap valign="top">  x < -1/2 &or; x &ge; 1/2 <sup>&nbsp;</sup></td> 
                 <td valign="top" > &rArr; <sup>&nbsp;</sup></td> 
                 <td valign="top"> &Pi;  = 0<sup>&nbsp;</sup></td>
               </tr>
            </table>
          </center>
        </p>
<p class="par">
</p>
<p class="par">
i, j, k running through the number of pixels in each direction. This approximation becomes important considering the next step.
</p>



<a name="Instrumental function"><h4>Instrumental function</h4></a>
<p class="par">
The instrumental function is a 3D Gaussian, which gets convolved with <i>I</i><sub>2</sub> via a 3D fast (and with that, discrete) Fourier transform, making use of the <a href="http://www.fftw.org/">FFTW library</a>. 

</p>
<p class="par">
In the spatial domain, the instrumental function is a 2D Gaussian with a major axis tilted by a beam position angle w.r.t. the North. With the major-axis Half-Power-Beam-Width BMAJ (HPBW, in arcsec) and the minor axis Half-Power-Beam-Width BMIN (HPBW, in arcsec) and the beam position angle BPA (in arcsec) the user hence defines the point-spread function
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (48)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>S</i><sub>xy</sub>(BMAJ, BMIN, BPA)(<i>x</i>, <i>y</i>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
<td valign="top"><i>exp</i>(-(A<sup>-1</sup><sub>B</sub><sup>x</sup>(BPA)(<i>x</i>, <i>y</i>))<sup>2</sup>(2&#183;&sigma;<sup>2</sup><sub>maj</sub>)<sup>-1</sup>)&middot;<i>exp</i>(-(A<sup>-1</sup><sub>B</sub><sup>y</sup>(BPA)(<i>x</i>, <i>y</i>))<sup>2</sup>(2&#183;&sigma;<sup>2</sup><sub>min</sub>)<sup>-1</sup>)<sup>&nbsp;</sup>
        </td>
        <td align="left" rowspan="2" nowrap>&nbsp;&nbsp;&nbsp;&nbsp;, with</td> 
      </tr>
     </table>
  </center>
</p>
<p class="par">
the rotation A<sub>B</sub>(BPA) given by
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (49)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  A<sup>x</sup><sub>B</sub>(BPA)(<i>x</i>, <i>y</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>cos</i>(&#960;&#183;BPA/180&#176;)-y&#183;<i>sin</i>(&#960;&#183;BPA/180&#176;)<sup>&nbsp;</sup>        </td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;, and</td> 
      </tr>
      <tr>
        <td nowrap valign="top">  A<sup>y</sup><sub>B</sub>(BPA)(<i>x</i>, <i>y</i>) <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> x&#183;<i>sin</i>(&#960;&#183;BPA/180&#176;)+y&#183;<i>cos</i>(&#960;&#183;BPA/180&#176;)<sup>&nbsp;</sup></td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
the dispersions being derived from the HPBWs
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="3"> (50)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  &sigma;<sub>maj</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (<i>ln</i>(256))<sup>-1/2</sup> BMAJ<sup>&nbsp;</sup> </td>
        <td valign="top" > &asymp; <sup>&nbsp;</sup></td> 
        <td valign="top"> 2.35 BMAJ <sup>&nbsp;</sup> </td>
        <td align="left" rowspan="3" nowrap> &nbsp;&nbsp;&nbsp;.</td> 
      </tr>
      <tr>
        <td nowrap valign="top">  &sigma;<sub>min</sub>  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> (<i>ln</i>(256))<sup>-1/2</sup> BMIN<sup>&nbsp;</sup> </td>
        <td valign="top" > &asymp; <sup>&nbsp;</sup></td> 
        <td valign="top"> 2.35 BMIN <sup>&nbsp;</sup> </td>
      </tr>
    </table>
  </center>
</p>
<p class="par">
In the velocity domain, with the global dispersion CONDISP, the user defines the instrumental function (notice that this is a normalised Gaussian)
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (51)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>S</i><sub>V<sub>z</sub></sub>(CONDISP)(<i>V</i><sub>z</sub>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top">(2&#960;&#183;CONDISP<sup>2</sup>)<sup>-1/2</sup><i>exp</i>(-<i>V</i><sup>2</sup><sub>z</sub>(2&#183;CONDISP<sup>2</sup>)<sup>-1</sup>)<sup>&nbsp;</sup>
        </td>
        <td align="left" rowspan="2" nowrap>&nbsp;&nbsp;&nbsp;&nbsp;.</td> 
      </tr>
     </table>
  </center>
</p>
<p class="par">
Then, the final model intensity <i>I</i> is the result of a convolution with the combined instrumental function (the multiplication with the limited Shah-function again inticating that the convolution is a discrete FFT convolution)
</p>
<p>
  <center>
    <table style="align:center" BORDER="0" rules="none" cellpadding="5" summary="TiRiFiC web page">
      <tr>
        <td align="left" rowspan="2"> (52)&nbsp;&nbsp;&nbsp; </td> 
        <td nowrap valign="top">  <i>I</i>(x, y, <i>V</i><sub>z</sub>)  <sup>&nbsp;</sup></td> 
        <td valign="top" > = <sup>&nbsp;</sup></td> 
        <td valign="top"> &Sigma;<sub>i,j,k</sub> &#948(<i>x</i>-i&middot;&Delta;<sub>x</sub>) &#948(<i>y</i>-j&middot;&Delta;<sub>y</sub>) &#948(<i>V</i><sub>z</sub>-k&middot;&Delta;<sub>V<sub>z</sub></sub>) (&int; &int; &int;&nbsp; <i>I</i><sub>2</sub>(<i>x</i>-<i>x</i>&prime;, <i>y</i>-<i>y</i>&prime;, <i>V</i><sub>z</sub>-<i>V</i>&prime;<sub>z</sub>) &middot;  <i>S</i><sub>V<sub>z</sub></sub>(CONDISP)(<i>V</i>&prime;<sub>z</sub>) &middot; <i>S</i><sub>xy</sub>(BMAJ, BMIN, BPA)(<i>x</i>&prime;, <i>y</i>&prime;) d<i>x</i>&prime; d<i>y</i>&prime; d<i>V</i>&prime;<sub>z</sub>)<sup>&nbsp;</sup>
        </td>
        <td align="left" rowspan="2" nowrap>&nbsp;&nbsp;&nbsp;&nbsp;,</td> 
      </tr>
     </table>
  </center>
</p>
<p class="par">
resulting in a data cube in units Jy beam<sup>-1</sup>. The global dispersion CONDISP is often used to combine instrumental- and (source-) intrinsic dispersion, to improve the computational performance (making use of the speed of the FFT).
The consequence of the convolution with the instrumental function <i>after</i> gridding (not as it happens in nature) is a slight error that might become visible in the model. If the required accuracy is high, a finer sampling of the input data cube or the usage of the radially dependent dispersion SDIS is recommended. Note that because of the use of the FFT, aliasing is present in the final data cube. If the distance of the model to the borders of the data cube are too small, the effect becomes significant. Always leave a border of 5-6 &sigma; or 2.5 - 3 HPBWs between the model and the borders of the float-accuracy (input) data cube. 
</p>






<a name="Summary of parameters described here"><h3>Summary of parameters described here</h3></a>
<center>
<table rules="all" border="1" cellpadding="5" summary="Parameters described here">
  <tr border="3" frame="above">
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#NUR"><b>NUR</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Number of grid nodes (ring radii) </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RADI"><b>RADI</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">arcsec </td>
    <td align="left">List of grid nodes (ring radii)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RADSEP"><b>RADSEP</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">pixel </td>
    <td align="left">Separation of sub-grids (sub-rings)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RADSEP_i"><b>RADSEP_i</b></a></td>
    <td align="center">Geometrical (required)</td>
    <td align="center">pixel </td>
    <td align="left">Separation of sub-grids (sub-rings), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#INTY"><b>INTY</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Interpolation scheme for sub-grid (sub-ring) parameters; 0: linear, 1: natural cubic spline, 2: natural Akima</td>
  <tr>
    <td align="center" style="border-top-width:medium" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ISEED"><b>ISEED</b></a></td>
    <td align="center"></td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left"> Constant surface brightness</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#NDISKS"><b>NDISKS</b></a></td>
    <td align="center">Geometrical </td>
    <td align="center">&nbsp; </td>
    <td align="left"> Number of disks</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SBR"><b>SBR</b></a></td>
    <td align="center">Geometrical (default 1803)</td>
    <td align="center"> &nbsp; </td>
    <td align="left"> Seed for random-number generator</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SBR_i"><b>SBR_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left"> Constant surface brightness, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SMkA"><b>SMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of harmonic surface-brightness distortion kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SMkP"><b>SMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic surface-brightness distortion kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SMkA_i"><b>SMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of harmonic surface-brightness distortion kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SMkP_i"><b>SMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic surface-brightness distortion kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkA"><b>GAkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkP"><b>GAkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkD"><b>GAkD</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec</sup> </td>
    <td align="left">Dispersion of kth Gaussian surface-brightness distortion (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkA_i"><b>GAkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">Jy km s<sup>-1</sup> arcsec<sup>-2</sup> </td>
    <td align="left">Amplitude of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkP_i"><b>GAkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#GAkD_i"><b>GAkD_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec</sup> </td>
    <td align="left">Dispersion of kth Gaussian surface-brightness distortion (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#AZkP"><b>AZkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Central positions of modelled azimuthal range (k = 1, 2)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#AZkW"><b>AZkW</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Width of modelled azimuthal range (k = 1, 2)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#AZkP_i"><b>AZkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Central positions of modelled azimuthal range (k = 1, 2), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#AZkW_i"><b>AZkW_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Width of modelled azimuthal range (k = 1, 2), ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LTYPE"><b>LTYPE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> </td>
    <td align="left">Vertical density distribution: 0: constant, 1: Gaussian, 2: sech<sup>2</sup>, 3: exponential, 4: Lorentzian </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#Z0"><b>Z0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Thickness of disk</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LTYPE_i"><b>LTYPE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> </td>
    <td align="left">Vertical density distribution: 0: constant, 1: Gaussian, 2: sech<sup>2</sup>, 3: exponential, 4: Lorentzian, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#Z0_i"><b>Z0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Thickness of disk, ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VROT"><b>VROT</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Mid-plane Rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ROkA"><b>ROkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), first disk</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ROkP"><b>ROkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), first disk</td>
  <tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVRO"><b>DVRO</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of rotation velocity </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDRO"><b>ZDRO</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VRAD"><b>VRAD</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane radial velocity (outwards positive)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RAkA"><b>RAkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic radial velocity kth order (k = 1, ..., 4), first disk</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RAkP"><b>RAkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic radial velocity kth order (k = 1, ..., 4), first disk</td>
  <tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVRA"><b>DVRA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of radial velocity </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDRA"><b>ZDRA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in radial velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VVER"><b>VVER</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane vertical velocity  </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVVE"><b>DVVE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of vertical velocity  </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDVE"><b>ZDVE</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in vertical velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VROT_i"><b>VROT_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Mid-plane Rotation velocity, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ROkA_i"><b>ROkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ROkP_i"><b>ROkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic tangential ("rotation") velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  <tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVRO_i"><b>DVRO_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of rotation velocity, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDRO_i"><b>ZDRO_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in rotation velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VRAD_i"><b>VRAD_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane radial velocity (outwards positive), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RAkA_i"><b>RAkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonic radial velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#RAkP_i"><b>RAkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> degrees </td>
    <td align="left">Phase of harmonic radial velocity kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  <tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVRA_i"><b>DVRA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of radial velocity, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDRA_i"><b>ZDRA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in radial velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VVER_i"><b>VVER_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left"> Mid-plane vertical velocity, ith disk, i = 2, 3, ...  </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#DVVE_i"><b>DVVE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> arcsec<sup>-1</sup> </td>
    <td align="left">Vertical gradient of vertical velocity, ith disk, i = 2, 3, ...  </td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#ZDVE_i"><b>ZDVE_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> arcsec </td>
    <td align="left">Onset height above plane for change in vertical velocity</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WM0A"><b>WM0A</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement 0th order: constant vertical displacement</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WMkA"><b>WMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WMkP"><b>WMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic vertical displacement kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WM0A_i"><b>WM0A_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement 0th order: constant vertical displacement, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WMkA_i"><b>WMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Amplitude of harmonic vertical displacement kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#WMkP_i"><b>WMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonic vertical displacement kth order (k = 1, ..., 4), ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#INCL"><b>INCL</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#INCL_i"><b>INCL_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination, ith disk, i = 2, 3, ...</td>
  </tr>

  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LC0"><b>LC0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected major axis</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LS0"><b>LS0</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected minor axis</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LC0_i"><b>LC0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected major axis, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#LS0_i"><b>LS0_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">arcsec </td>
    <td align="left">Shift along the projected minor axis, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VM0A"><b>VM0A</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity 0th order: constant shift in velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VMkA"><b>VMkA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VMkP"><b>VMkP</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VM0A_i"><b>VM0A_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity 0th order: constant shift in velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VMkA_i"><b>VMkA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center"> km s<sup>-1</sup> </td>
    <td align="left">Amplitude of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VMkP_i"><b>VMkP_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Phase of harmonics in LOS velocity kth order (k = 1, ..., 4)</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#PA"><b>PA</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#PA_i"><b>PA_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Inclination, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SDIS"><b>SDIS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Radially dependent velocity dispersion</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#CLNR"><b>CLNR</b></a></td>
    <td align="center">Geometrical (default 1)</td>
    <td align="center">&nbsp; </td>
    <td align="left">Number of sub-clouds per cloud</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#SDIS_i"><b>SDIS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Radially dependent velocity dispersion, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#CLNR_i"><b>CLNR_i</b></a></td>
    <td align="center">Geometrical (default 1)</td>
    <td align="center"> </td>
    <td align="left">Number of sub-clouds per cloud, ith disk, i = 2, 3, ... </td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#XPOS"><b>XPOS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Right ascension</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#YPOS"><b>YPOS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">declination</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VSYS"><b>VSYS</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Recession velocity</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#XPOS_i"><b>XPOS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Right ascension, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#YPOS_i"><b>YPOS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">degrees </td>
    <td align="left">Declination, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#VSYS_i"><b>VSYS_i</b></a></td>
    <td align="center">Geometrical (default 0)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Recession velocity, ith disk, i = 2, 3, ...</td>
  </tr>
  <tr>
    <td align="center" style="border-top-width:medium">Name</td>
    <td align="center" style="border-top-width:medium">Category</td>
    <td align="center" style="border-top-width:medium">Unit</td>
    <td align="center" style="border-top-width:medium">Description</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#BMAJ"><b>BMAJ</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">arcsec </td>
    <td align="left">Observational beam HPBW, major axis</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#BMIN"><b>BMIN</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">arcsec </td>
    <td align="left">Observational beam HPBW, minor axis</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#BPA"><b>BPA</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">degrees </td>
    <td align="left">Position angle of observational beam major axis, measured anticlockwise from N</td>
  </tr>
  <tr>
    <td align="left"><a href="model_geometry.html#CONDISP"><b>CONDISP</b></a></td>
    <td align="center">Geometrical (no default)</td>
    <td align="center">km s<sup>-1</sup> </td>
    <td align="left">Global velocity dispersion</td>
  </tr>
</table>
</center>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ************************* -->
<!-- ************************* -->
<!-- ********  FOOTER  ******* -->
<!-- ************************* -->
<!-- ************************* -->
<div id="footer">

<!-- Created: Fri Apr 13 2007 -->
<!-- hhmts start -->
Last modified: Mon Oct 30 13:03:01 SAST 2017
<!-- hhmts end -->
<br><a href="mailto:jozsa@ska.ac.za">Gyula J&oacute;zsa</a>
</div>
  </body>
</html>
